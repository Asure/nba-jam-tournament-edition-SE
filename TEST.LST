TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

                                                                     PAGE    1

       1                            .file   "test.asm"
       3                            .width  132
       4                            .option b,d,l,t
       5                            .mnolist
       6                    
       7                            
       8                            .include        "mproc.equ"
       9                            .include        "disp.equ"
      10                            .include        "sys.equ"
      11                            .include        "gsp.equ"
      12                            .include        "imgtbl.glo"
      13                            .include        "imgtbl2.glo"
      14                    
      15                            .include        "game.equ"
      16                            .include        "link.equ"
      17                            .include        "menu.equ"
      18                            .include        "shawn.hdr"             ;Macros
      19                            .include        dipequ.asm
      20                            .include        mac2.asm
      21                    
      22                    
      23                    
      24                            .def            fudge_switches, fudge_switches2, fudge_switches_diag
      25                            .DEF            DIAG,CHK_CMOS
      26                            .DEF            GEN_MENU,B_MENU
      27                            .DEF            TOP_BOX                 ;,WT_ADV
      28                            .DEF            MAIN_RET,GMENULEV
      29                            .DEF            AREUSURE
      30                            .DEF            F_TITLE
      31                            .DEF            ST_STICK
      32                            .DEF            GETSTICK
      33                            .DEF            SUR_MESS
      34                            .DEF            SURE_BOX
      35                            .DEF            CPU_RET
      36                            .DEF            GET_FAC
      37                            .DEF            MENU_TOP
      38                            .DEF            RED_BOX
      39                            .DEF            BLNKHELP,H_SLAVE
      40                            .DEF            DOBORDER
      41                            .DEF            COL_INST
      42                            .DEF            STD_BORD
      43                            .DEF            DIAG_EX
      44                            .DEF            WAIT_BUT
      45                            .DEF            DIGSRT
      46                            .DEF            SND_MADE
      47                            .DEF            NO_CLEAR
      48                            .DEF            LAST_BUT
      49                            .DEF            G_BORDER
      50                            .DEF            FORM_SWS
      51                            .DEF            CKTEST, CKDIAG, DIAG_COLORS
      52                    
      53                    
      54                            .REF            CMOS_VAL,L_MESS
      55                            .REF            LM_SETUP,LM_FINIS
      56                            .REF            FORM_ADC
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE    2

      57                            .REF            F_ADC_S
      58                            .REF            GET_AUD
      59                            .REF            FAC_SET
      60                            .REF            CRED_P
      61                            .REF            BAD_AUD
      62                            .REF            CLR_AUD
      63                            .REF            ADJ_PAGE
      64                            .REF            COIN_PAG
      65                            .REF            ROM_NAME
      66                            .REF            STORE_AUDIT
      67                            .REF            INIT_TAB
      68                            .REF            VAL_TAB
      69                            .REF            P_FORK
      70                            .REF            RC_BYTEI
      71                            .REF            RC_BYTE
      72                            .REF            RC_WORD
      73                            .REF            RC_LONG
      74                            .REF            RC_LONGI
      75                            .REF            WC_BYTE
      76                            .REF            WC_BYTEI
      77                            .REF            WC_WORD
      78                            .REF            WC_WORDI
      79                            .REF            WC_LONG
      80                            .REF            WC_LONGI
      81                            .REF            MEN_MAIN,ANY_BUT,MEN_YN
      82                            .REF            MESS_FAC
      83                            .REF            GO_DIAG           ;ROUTINE FOR DIAGNOSTIC MENU
      84                            .REF            RTR_LEV,ROM_LEV
      85                            .REF            FAC_STUF
      86                            .REF            SCODE             ;SYNTH CODE CURRENTLY BEING MADE
      87                            .REF            DCODE             ;DIG CODE CURRENTLY BEING MADE
      88                    
      89                    
      90                            .REF    DO_ADJH, CKDIP, MEN_ADJ
      91                    
      92                    
      93                    
      94                            .REF    WIPEOUT
      95                    
      96                    
      97                    
      98                            .ref    TWOPLAYERS                      ;0 = NO, 1 = YES 2 players
      99                    
     100                            .REF    WARMSET
     101                            .REF    QSNDRST
     102                            .REF    FILLAREA
     103                            .REF    STRNGLEN
     104                    
     105                            .ref    osgfont_t
     106                            .REF    RD15FONT,RD7FONT,STRCNRM,STRCNRM_1,GAMSTATE
     107                            .REF    IRQSKYE,BLNKAREA,STRLNRM,CLR_SCRN
     108                            .REF    P1DATA,P2DATA
     109                            .REF    WDOGDIS, READ_DIP, dpageflip_off, SWSET1, SWSET2
     110                    
     111                            .REF    PALFRAM, pal_set, pal_getf
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE    3

     112                    
     113                    
     114 00000000                   .BSS            MAIN_RET,16           ;FLAG SAYS RETURN TO MAIN MENU
     115 00000010                   .BSS            GMENULEV,16           ;HOW DEEP INTO GEN_MENU WE ARE
     116 00000020                   .BSS            SND_MADE,16           ;SOUND TEST FLAG
     117 00000030                   .BSS            NO_CLEAR,16           ;FLAG TELLS GET_MENU NOT TO CLEAR!
     118 00000040                   .BSS            LAST_BUT,32
     119 00000060                   .BSS            SPTEMP,32             ;STACK POINTER TEMP
     120                    
     121                            .def    fswitches_cur,fswitches_last,fswitches_down
     122                    
     123 00000080                   .bss            fswitches_cur,32
     124 000000a0                   .bss            fswitches_last,32
     125 000000c0                   .bss            fswitches_down,32
     126                    
     127 00000000                   .text
     128                    
     129                    
     130 00000000     f3f7  beep1_snd       .word   0f3f7H,08H,08080H,0     ;MENU BAR MOVE SOUND
     131 00000040     f3f7  SELECT_SND      .word   0f3f7H,08H,08084H,0     ;MENU OPTION SELECT SOUND
     132 00000080     f3df  UHOH            .WORD   0F3DFH,010H,08092H,0    ;FAILURE OF ANY KIND
     133                    
     134                    
     135 000000c0           CPU_RET:
     136 000000c0     0d3f          CALLR   DIGSRT          ;MAKE SURE WE'RE IN TEST MODE
         000000d0     0250  
     137                    
     138 000000e0     5600          CLR     A0
     139 000000f0     0580          MOVE    A0,@GMENULEV    ;INDICATE WE'RE AT LEVEL ZERO.
         00000100 00000010- 
     140                    
     141 00000120     09e0          MOVI    RTR_LEV,A0      ;THIS IS THE LEVEL TO DIVE TO
         00000130 00000000! 
     142 00000150     03a0          NEG     A0              ;NEGATE IT AS FLAG TO DIVE.
     143 00000160     0580          MOVE    A0,@MAIN_RET    ;INDICATE
         00000170 00000000- 
     144 00000190     c080          JAUC    DIAG_RESTART    ;NOW START IT UP....
         000001a0 000006f0' 
     145                    
     146                    
     147                    
     148 000001c0           WAIT_BUT:
     149 000001c0     0d3f          CALLR   FORM_SWS        ;1ST STATE DOESN'T COUNT
         000001d0     06b8  
     150                    
     151                    
     152 000001e0           WB1:    
     153 000001e0                   SLEEPK  1
     154 00000220     0d3f          CALLR   FORM_SWS
         00000230     06b2  
     155 00000240     03e1          NOT     A1              ;LAST = 0 AND NOW = 1 MEANS EDGE!
     156                    
     157 00000250     5020          AND     A1,A0           ;1'S WHERE WE HAVE POSITIVE EDGE.
     158 00000260     0b80          ANDI    BUTTONS,A0      ;IS IT A BUTTON?
         00000270 ffff0f0f  
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE    4

     159 00000290     caf4          JRZ     WB1
     160 000002a0                   SOUND1  beep1_snd
     161 00000300                   RETP
     162                    
     163                    
     164 00000330           CKTEST
     165 00000330                   PUSH    A0
     166 00000340     0d5f          CALLA   READ_DIP
         00000350 00000000! 
     167 00000370     0b80          ANDI    DPTEST,A0
         00000380 ffffff7f  
     168 000003a0     cb0a          JRNZ    CKRET
     169 000003b0     07a0          MOVE    @SWITCH,A0,L
         000003c0 01600000  
     170 000003e0     03e0          NOT     A0
     171 000003f0     0b80          ANDI    DIAG_BITS,A0
         00000400 ffefffff  
     172 00000420     ca80          JAZ     WARMSET                 ; WE BE OUTTA HERE!
         00000430 00000000! 
     173 00000450           CKRET
     174 00000450                   PULL    A0
     175 00000460     0960          RETS
     176                    
     177                    
     178 00000470           CKDIAG
     179 00000470     5600          CLR     A0
     180 00000480     0d5f          CALLA   READ_DIP
         00000490 00000000! 
     181 000004b0     0b80          ANDI    DPTEST,A0
         000004c0 ffffff7f  
     182 000004e0     cb08          JRNZ    CKDGO
     183 000004f0     07a0          MOVE    @SWITCH,A0,L
         00000500 01600000  
     184 00000520     03e0          NOT     A0
     185 00000530     0b80          ANDI    DIAG_BITS,A0
         00000540 ffefffff  
     186 00000560     ca01          JRZ     CKDRET
     187 00000570           CKDGO
     188 00000570     1820          MOVK    1,A0
     189 00000580           CKDRET
     190 00000580     4c00          MOVE    A0,A0
     191 00000590     0960          RETS
     192                    
     193                    
     194 000005a0           DIAG
     195 000005a0     09c0          movi    AUDSTAT,a0
         000005b0     0018  
     196 000005c0     5621          clr     a1
     197 000005d0     0d5f          calla   STORE_AUDIT
         000005e0 00000000! 
     198 00000600     05a0          move    @GAMSTATE,a0
         00000610 00000000! 
     199 00000630     ce80          jan     SUCIDE          ;In diagnostics
         00000640 00000000! 
     200                    
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE    5

     201 00000660           DIAG_JUMP
     202 00000660     0d3f          CALLR   DIGSRT          ;MAKE SURE WE'RE IN TEST MODE
         00000670     01f6  
     203                    
     204 00000680     5600          CLR     A0
     205 00000690     0580          MOVE    A0,@MAIN_RET    ;CLEAR THE FLOAT TO TOP FLAG.
         000006a0 00000000- 
     206 000006c0     0580          MOVE    A0,@GMENULEV    ;INDICATE WE'RE AT LEVEL ZERO.
         000006d0 00000010- 
     207                    
     208 000006f0           DIAG_RESTART
     209 000006f0     09e8          MOVI    MEN_MAIN,A8
         00000700 00000000! 
     210 00000720                   JSRP    GEN_MENU        ;PROCESS THIS MENU!
     211                    
     212                    
     213 00000790           DIAG_EX
     214 00000790                   SLEEPK  2               ;LET DMA EMPTY OUT IF NECESSARY
     215                    
     216                    
     217                    
     218                    
     219                    
     220 000007d0     0d5f          CALLA   CLR_SCRN
         000007e0 00000000! 
     221 00000800     0d5f          CALLA   CMOS_VAL                ; VALIDATE THE CMOS
         00000810 00000000! 
     222 00000830     0d5f          CALLA   CKTEST
         00000840 00000330' 
     223 00000860     0d5f          CALLA   READ_DIP
         00000870 00000000! 
     224 00000890     0b80          ANDI    DPTEST,A0
         000008a0 ffffff7f  
     225 000008c0     0780          MOVE    A0,@SWSET2,L
         000008d0 00000000! 
     226 000008f0     ca0b          JRZ     DE2
     227 00000900     09e8          MOVI    NOTCLOSEDDIP,A8
         00000910 00000fd0' 
     228 00000930                   JSRP    L_MESS
     229 000009a0     c01e          jruc    emtmout
     230 000009b0           DE2
     231 000009b0     07a0          MOVE    @SWITCH,A0,L
         000009c0 01600000  
     232 000009e0     03e0          NOT     A0
     233 000009f0     0b80          ANDI    DIAG_BITS,A0
         00000a00 ffefffff  
     234 00000a20     07ae          MOVE    @SWSET2,A14,L
         00000a30 00000000! 
     235 00000a50     540e          OR      A0,A14
     236 00000a60     078e          MOVE    A14,@SWSET2,L
         00000a70 00000000! 
     237 00000a90     4c00          MOVE    A0,A0
     238 00000aa0     ca0b          JRZ     DE3
     239 00000ab0     09e8          MOVI    NOTCLOSEDJAMMA,A8
         00000ac0 000011c0' 
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE    6

     240 00000ae0                   JSRP    L_MESS
     241 00000b50     c003          jruc    emtmout
     242 00000b60           DE3
     243 00000b60     c080          JAUC    WARMSET         
         00000b70 00000000! 
     244 00000b90           emtmout
     245 00000b90     09e8          MOVI    NOTCLOSEDWAIT,A8
         00000ba0 00001360' 
     246 00000bc0                   JSRP    L_MESS
     247                    
     248 00000c30     0d5f          CALLA   fudge_switches          ;get fudged switches in a0
         00000c40 00006dd0' 
     249 00000c60     0b80          andi    BUTTONS|START_BITS,a0
         00000c70 f9db0f0f  
     250 00000c90     0780          MOVE    A0,@SWSET1,L
         00000ca0 00000000! 
     251 00000cc0           DE4
     252 00000cc0                   SLEEPK  1                       ;APPEASE THE MAIN LOOP
     253 00000d00     0d3f          CALLR   CKTEST                  ;CHECK STATUS OF TEST SWITCH
         00000d10     ff61  
     254                    
     255 00000d20     0d5f          CALLA   fudge_switches          ;get fudged switches in a0
         00000d30 00006dd0' 
     256 00000d50     07a1          MOVE    @SWSET1,A1,L
         00000d60 00000000! 
     257 00000d80     0b80          andi    BUTTONS|START_BITS,a0
         00000d90 f9db0f0f  
     258 00000db0     4801          CMP     A0,A1
     259 00000dc0     cb1c          JRNZ    DE5
     260                    
     261                    
     262 00000dd0     07a3          MOVE    @SWSET2,A3,L
         00000de0 00000000! 
     263 00000e00     4c61          MOVE    A3,A1
     264 00000e10     0d5f          CALLA   READ_DIP
         00000e20 00000000! 
     265 00000e40     0b80          ANDI    DPTEST,A0
         00000e50 ffffff7f  
     266 00000e70     0b81          ANDI    DPTEST,A1
         00000e80 ffffff7f  
     267 00000ea0     4801          CMP     A0,A1
     268 00000eb0     cb8d          JRNE    DIAG_EX
     269                    
     270                    
     271 00000ec0     07a0          MOVE    @SWITCH,A0,L            ;GOTTA SEE IF TIME TO LEAVE
         00000ed0 01600000  
     272 00000ef0     03e0          NOT     A0
     273 00000f00     0b80          ANDI    DIAG_BITS,A0
         00000f10 ffefffff  
     274 00000f30     0b83          ANDI    DIAG_BITS,A3
         00000f40 ffefffff  
     275 00000f60     4803          CMP     A0,A3
     276 00000f70     cb81          JRNE    DIAG_EX
     277                    
     278 00000f80     c0d3          JRUC    DE4
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE    7

     279                    
     280 00000f90           DE5
     281 00000f90     0d3f          CALLR   CKTEST                  ; ONE FINAL TIME ( STILL WRONG )
         00000fa0     ff38  
     282 00000fb0     c000          JRUC    DIAG_JUMP
         00000fc0     ff69  
     283                    
     284                    
     285 00000fd0           NOTCLOSEDDIP
     286 00000fd0                   MESS_MAC RD7FONT,SPACING07,200,50,COLOR_RED,STRCNRM,0
     287 00001070       44          .STRING "DIPSWITCH TEST SELECT (UJ2 # 8) CLOSED.",0,0
     288 000011c0                   .EVEN
     289                    
     290 000011c0           NOTCLOSEDJAMMA
     291 000011c0                   MESS_MAC RD7FONT,SPACING07,200,70,COLOR_RED,STRCNRM,0
     292 00001260       43          .STRING "COIN DOOR TEST SWITCH CLOSED.",0,0
     293 00001360                   .EVEN
     294                    
     295 00001360           NOTCLOSEDWAIT
     296 00001360                   MESS_MAC RD7FONT,SPACING07,200,120,COLOR_RED,STRCNRM,0
     297 00001400       50          .STRING "PRESS ANY BUTTON TO RETURN TO TEST MODE OR",0,1
     298 00001560                   .EVEN
     299 00001560                   MESS_MAC RD7FONT,SPACING07,200,132,COLOR_RED,STRCNRM,0
     300 00001600       4f          .STRING "OR",0,1
     301 00001620                   .EVEN
     302 00001620                   MESS_MAC RD7FONT,SPACING07,200,144,COLOR_RED,STRCNRM,0
     303 000016c0       4f          .STRING "OPEN THE SWITCH(S) TO RETURN TO GAME.",0,0
     304 00001800                   .EVEN
     305                    
     306              0000  MR_FONT   EQU     0
     307              0020  MR_TCAL   EQU     MR_FONT+LONG_SIZE
     308              0040  MR_TITLE  EQU     MR_TCAL+LONG_SIZE     ;POINTER TO TITLE FOR TILE BOX (IF NEC)
     309              0060  MR_TCLR   EQU     MR_TITLE+LONG_SIZE    ;COLOR OF TITLE
     310              0070  MR_WORDS  EQU     MR_TCLR+WORD_SIZE     ;STREAM OF WORDS TO COPY TO PDATA STARTS HERE
     311              0070  MR_X      EQU     MR_WORDS
     312              0080  MR_Y      EQU     MR_X+WORD_SIZE
     313              0090  MR_DY     EQU     MR_Y+WORD_SIZE
     314              00a0  MR_COL    EQU     MR_DY+WORD_SIZE
     315              00b0  MR_HITE   EQU     MR_COL+WORD_SIZE
     316              00c0  MR_BDY    EQU     MR_HITE+WORD_SIZE
     317              00d0  MR_DX     EQU     MR_BDY+WORD_SIZE
     318              00e0  MR_WID    EQU     MR_DX+WORD_SIZE
     319                            
     320 00001800           GEN_MENU
     321 00001800     05a0          MOVE    @GMENULEV,A0            ;KICK LEVEL POINTER
         00001810 00000010- 
     322 00001830     1020          INC     A0
     323 00001840     0580          MOVE    A0,@GMENULEV
         00001850 00000010- 
     324                    
     325 00001870     a30c          MOVE    A8,-*A12,L              ;SAVE MENU PTR
     326 00001880     1828          movk    1,A8                    ;START WITH "FIRST" ENTRY
     327 00001890     a10c          MOVE    A8,-*A12,W              ;PUT MENU NUMBER AS A WORD
     328                    
     329                    
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE    8

     330                    
     331 000018a0           GEN_LOOP
     332 000018a0     05a0          MOVE    @MAIN_RET,A0            ;ARE WE IN "EXIT" MODE?
         000018b0 00000000- 
     333 000018d0     ca0a          JRZ     NO_EXIT                 ;NO
     334                    
     335 000018e0     ce44          JRN     DIVE_TO_MONITOR         ;WE'RE DIVING TO MONITOR PATTERNS.
     336                    
     337 000018f0     05a0          MOVE    @GMENULEV,A0            ;CHECK LEVEL
         00001900 00000010- 
     338 00001920     1420          subk    1,a0                    ;are we at level 1
     339 00001930     cb33          jrne    GEN_EXIT                ;NOPE.....POP UP A LEVEL.
     340                    
     341                    
     342 00001940           DIVE_COMPLETE
     343 00001940     5600          CLR     A0
     344 00001950     0580          MOVE    A0,@MAIN_RET            ;NOW WE MAY PROCEED!
         00001960 00000000- 
     345                    
     346 00001980           NO_EXIT
     347 00001980     05a0          MOVE    @NO_CLEAR,A0            ;INHIBIT CLEAR?
         00001990 00000030- 
     348 000019b0     cb04          JRNZ    SKIP_CLR
     349 000019c0     57bd          CLR     B13
     350 000019d0     0d5f          CALLA   CLR_SCRN                ;CLEAR THE SCREEN
         000019e0 00000000! 
     351                    
     352 00001a00           SKIP_CLR
     353 00001a00     5600          CLR     A0
     354 00001a10     0580          MOVE    A0,@NO_CLEAR            ;AND RE-SET IT!
         00001a20 00000030- 
     355                    
     356 00001a40     b788          MOVE    *A12(WORD_SIZE),A8,L    ;GET MENU DESCRIPTOR
         00001a50     0010  
     357 00001a60                   JSRP    MENU_TOP
     358 00001ad0                   JSRP    RED_BOX         ;PUT UP MAIN MENU INSTRUCTIONS
     359                    
     360 00001b40     8589          MOVE    *A12,A9                 ;GET MENU NUMBER TO USE
     361 00001b50                   JSRP    B_MENU                  ;GET RESULT
     362                    
     363 00001bc0           PHONEY_MENU_RET
     364                    
     365 00001bc0     4d4a          MOVE    A10,A10                 ;WAS IT ADVANCE?
     366 00001bd0     ca01          JRZ     NO_KICK                 ;NOPE....LEAVE WHERE HE CAME FROM
     367                    
     368 00001be0     1028          INC     A8                      ;KICK INDEX BY 1 FOR NEXT TIME
     369 00001bf0           NO_KICK
     370 00001bf0     810c          MOVE    A8,*A12                 ;AND LEAVE ON THE STACK
     371                    
     372 00001c00     4d29          MOVE    A9,A9                   ;NOW JSRP THE ROUTINE
     373 00001c10     ca05          JRZ     GEN_EXIT                ;NONE THERE....ITS "EXIT"
     374                    
     375                    
     376 00001c20     09e7          MOVI    GEN_LOOP,A7
         00001c30 000018a0' 
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE    9

     377 00001c50     a2ec          MOVE    A7,-*A12,L              ;PUSH RET ADDR
     378 00001c60     0169          JUMP    A9
     379                    
     380 00001c70           GEN_EXIT
     381 00001c70     0b0c          ADDI    WORD_SIZE+LONG_SIZE,A12 ;POP THE ARGUMENTS
         00001c80     0030  
     382 00001c90     05a0          MOVE    @GMENULEV,A0            ;KICK LEVEL POINTER
         00001ca0 00000010- 
     383 00001cc0     1420          DEC     A0
     384 00001cd0     0580          MOVE    A0,@GMENULEV
         00001ce0 00000010- 
     385 00001d00                   RETP
     386                    
     387 00001d30           DIVE_TO_MONITOR:
     388 00001d30     05a0          MOVE    @GMENULEV,A0            ;CHECK LEVEL
         00001d40 00000010- 
     389 00001d60     0b40          CMPI    1,A0                    ;ARE WE AT LEVEL 1
         00001d70     fffe  
     390 00001d80     cb06          JRNZ    DTM1                    ;NOPE....SET "MONITOR" LEVEL
     391 00001d90     1828          MOVK    1,A8
     392 00001da0     09e9          MOVI    GO_DIAG,A9              ;ROUTINE FOR DIAGNOSTIC MENU
         00001db0 00000000! 
     393 00001dd0     182a          MOVK    1,A10                   ;RETURN AS IF ADVANCE WAS PRESSED
     394 00001de0     c0dd          JRUC    PHONEY_MENU_RET         ;WE'RE READY TO CALL DIAG MENU
     395 00001df0           DTM1:   
     396 00001df0     05a8          MOVE    @MAIN_RET,A8            ;FLAG IS OPPOSITE OF ENTRY NUMBER
         00001e00 00000000- 
     397 00001e20     03a8          NEG     A8                      ;THIS IS RETURN LEVEL!
     398 00001e30     810c          MOVE    A8,*A12                 ;PUT MENU NUMBER AS A WORD
     399 00001e40     c0af          JRUC    DIVE_COMPLETE           ;THIS COMPLETES THE DIVE!
     400                    
     401                    
     402 00001e50           MENU_TOP:
     403 00001e50     b702          MOVE    *A8(MR_TITLE),A2,L      ;GET TITLE INTO A2
         00001e60     0040  
     404 00001e70     b503          MOVE    *A8(MR_TCLR),A3         ;AND COLOR INTO A3
         00001e80     0060  
     405                    
     406 00001e90           TOP_BOX:
     407 00001e90     a30c          MOVE    A8,-*A12,L              ;PUSH MENU PTR
     408 00001ea0     0d3f          CALLR   SCR_BOX                 ;PUT UP THE TITLE BOX
         00001eb0     002c  
     409                    
     410 00001ec0     09e8          MOVI    MESS_TITLE,A8    ;SET PARAMETERS
         00001ed0 00009d60' 
     411 00001ef0     0d5f          CALLA   LM_SETUP         ;PUT IT OUT.
         00001f00 00000000! 
     412                    
     413 00001f20     4c48          MOVE    A2,A8            ;GET STRING IN THE CORRECT REGGIE
     414                    
     415 00001f30                   JSRP    LM_FINIS         ;AND PRINT IT!
     416                    
     417 00001fa0                   JSRP    SCR_REV          ;NOW ADD THE REV.
     418                    
     419 00002010     9788          MOVE    *A12+,A8,L       ;RESTORE THE MENU PTR
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   10

     420                    
     421 00002020                   RETP
     422                    
     423 00002050           SCR_REV:
     424 00002050     09e8          MOVI    MESS_REV,A8     ;GET READY FOR REV MESSAGE
         00002060 00009e00' 
     425 00002080     0d5f          CALLA   LM_SETUP        ;SETUP FOR REV MESSAGE
         00002090 00000000! 
     426                    
     427 000020b0     09e8          MOVI    ROM_NAME,A8     ;USE ROM COPY OF REV.
         000020c0 00000000! 
     428 000020e0                   JSRP    LM_FINIS        ;FINISH PRINTING MESSAGE
     429 00002150                   RETP
     430                    
     431 00002180           SCR_BOX:
     432 00002180     09e4          MOVI    TIT_ULX+(10000H*TIT_ULY),A4    ;UPPER LEFT
         00002190 00040005  
     433 000021b0     09e5          MOVI    TIT_LRX+(10000H*TIT_LRY),A5    ;UPPER LEFT
         000021c0 002a0185  
     434 000021e0     09c9          MOVI    COLOR_YELLOW,A9
         000021f0     0505  
     435 00002200     0d3f          CALLR   STD_BORD
         00002210     0608  
     436 00002220     0960          RETS
     437                    
     438                    
     439 00002230           RED_BOX:
     440 00002230     a30c          MOVE    A8,-*A12,L                       ;PUSH THE MENU PTR
     441                    
     442 00002240     09c9          MOVI    ROBO_RED,A9
         00002250     0303  
     443 00002260     0d3f          CALLR   COL_INST                ;THIS PRINTS BOX AND STASHES
         00002270     0018  
     444                    
     445 00002280     09e8          MOVI    MM_INST1,A8     ;POINT AT INSTRUCTIONS MESSAGE
         00002290 00009490' 
     446 000022b0                   JSRP    C_PD_M
     447                    
     448 00002320     09e8          MOVI    MM_INST2,A8     ;POINT AT INSTRUCTIONS MESSAGE
         00002330 000095e0' 
     449 00002350                   JSRP    C_PD_M
     450                    
     451 000023c0     9788          MOVE    *A12+,A8,L      ;GET BACK MENU PTR.
     452 000023d0                   RETP
     453                    
     454 00002400           COL_INST:
     455 00002400     0d3f          CALLR   STUFF_MENU_PROCESS               ;MOVE DATA INTO PDATA AREA
         00002410     0384  
     456 00002420     0d3f          CALLR   MEN_NUMS                         ;GET THE NUMBERS FOR THIS MENU
         00002430     000b  
     457 00002440     b0cd          MOVE    A6,*A13(PDATA),W                 ;STASH THE X CENTER
         00002450     0100  
     458 00002460     0b24          ADDI    10000H*INST_ULY,A4               ;UPPER LEFT Y
         00002470 002d0000  
     459 00002490     0b25          ADDI    10000H*INST_LRY,A5               ;UPPER LEFT X
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   11

         000024a0 004a0000  
     460 000024c0     0d3f          CALLR   STD_BORD
         000024d0     05dc  
     461 000024e0     0960          RETS
     462                    
     463 000024f0           MEN_NUMS:
     464 000024f0     0d3f          CALLR   MENU_UL_A4_A5                    ;LEFT X IN A4
         00002500     0542  
     465 00002510     0d3f          CALLR   MENU_LR_A6_A5                    ;RIGHT X IN A6
         00002520     0551  
     466 00002530     4cc5          MOVE    A6,A5                            ;COPY RIGHT X INTO A5
     467 00002540     4086          ADD     A4,A6                            ;FIND CENTER
     468 00002550     2fe6          SRL     1,A6                             ;A6 NOW HAS CENTER X (FOR LATER)
     469 00002560     0960          RETS
     470                    
     471 00002570           C_PD_M:
     472 00002570     0d5f          CALLA   LM_SETUP        ;SETUP THE MESSAGE
         00002580 00000000! 
     473 000025a0     b5a3          MOVE    *A13(PDATA),A3  ;GET THE X
         000025b0     0100  
     474 000025c0     ec69          movx    a3,a9           ;Move X
     475 000025d0     0161          JUMP    A1              ;AND "CALL" THE ROUTINE
     476                    
     477                    
     478 000025e0           DIGSRT
     479 000025e0     0d3f          CALLR   DIAG_STATE
         000025f0     0017  
     480 00002600     0d5f          CALLA   WIPEOUT         ;INITIALIZE THE OBJECT LIST
         00002610 00000000! 
     481 00002630     0d3f          CALLR   DIAG_COLORS     ;RESTART THE COLOR PROCESSES.
         00002640     0020  
     482 00002650     0d5f          CALLA   QSNDRST         ;kill any sounds in progress
         00002660 00000000! 
     483 00002680     0d5f          calla   dpageflip_off
         00002690 00000000! 
     484 000026b0     1820          MOVK    1,A0
     485 000026c0     0580          MOVE    A0,@DISPLAYON   ;WE NEED TO SEE THE STUFF
         000026d0 00000000! 
     486                    
     487 000026f0     09c0          movi    HEBLNKINIT,a0
         00002700     0032  
     488 00002710     0580          move    a0,@HEBLNK
         00002720 c0000010  
     489                    
     490 00002740     c080          jauc    CLR_SCRN        ;CLEAR THE SCREEN!
         00002750 00000000! 
     491                    
     492 00002770           DIAG_STATE
     493 00002770     5621          CLR     A1
     494 00002780     0d5f          CALLA   KILALL                  ;KILL ABSOLUTELY EVERYONE!
         00002790 00000000! 
     495                    
     496 000027b0     09c1          MOVI    DIAG_PID,A1             ;SET OUR ID TO DIAGNOSTICS MAN
         000027c0     0082  
     497 000027d0     b02d          MOVE    A1,*A13(PROCID)         ;PASS OUR ID TO FORKED PROCESS
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   12

         000027e0     0020  
     498                    
     499 000027f0     09c0          movi    INDIAG,a0
         00002800     ffff  
     500 00002810     0580          move    a0,@GAMSTATE            ;PUT US IN TEST MODE!
         00002820 00000000! 
     501 00002840     0960          rets
     502                    
     503                    
     504                    
     505              0004  NUM_DIAG_CYCLE_COLORS   .EQU    4
     506              003c  DIAG_CYCLE_COLOR_START  .EQU    03CH
     507                    
     508 000000e0                   .BSS    DIAG_CRAM,NUM_DIAG_CYCLE_COLORS*16,1    ;RAM FOR TRANSFER
     509                    
     510 00002850           DIAG_COLORS
     511 00002850     098f          MMTM    SP,A0,A1,A7
         00002860     c100  
     512 00002870     09c0          MOVI    COLRPID,A0
         00002880     0078  
     513 00002890     5621          CLR     A1
     514 000028a0     0581          MOVE    A1,@IRQSKYE
         000028b0 00000000! 
     515 000028d0     0781          move    a1,@PALFRAM,L
         000028e0 00000000! 
     516 00002900     0d5f          CALLA   KIL1C            ;KILL ALL COLOR UPDATE PROCESSES
         00002910 00000000! 
     517 00002930     09e0          MOVI    DIAGP,A0         ;CREATE DIAGNOSTICS PALLETTE
         00002940 00000000! 
     518 00002960     0d5f          CALLA   pal_getf
         00002970 00000000! 
     519 00002990     09c0          MOVI    COLRPID,A0
         000029a0     0078  
     520 000029b0     5621          CLR     A1
     521 000029c0     03e1          NOT     A1
     522 000029d0     0d5f          CALLA   KILALL
         000029e0 00000000! 
     523 00002a00                   CREATE  COLRPID,PC_TRANSFER
     524 00002a80                   CREATE  COLRPID,LFLASH
     525 00002b00                   CREATE  COLRPID,RGB
     526 00002b80                   CREATE  COLRPID,BPR
     527 00002c00                   CREATE  COLRPID,DECAY
     528 00002c80     09af          MMFM    SP,A0,A1,A7
         00002c90     0083  
     529 00002ca0     0960          RETS
     530                    
     531                    
     532 00002cb0     0d3f  RGB     CALLR   TABDRIVE
         00002cc0     008c  
     533 00002cd0 00002d20'         .LONG   RGBTAB,DIAG_CRAM+30H
     534 00002d10     0008          .WORD   8
     535 00002d20     7c00  RGBTAB  .WORD   07C00H,001FH,077A0H,0741AH,0FFFFH
     536                    
     537 00002d70     0d3f  DECAY   CALLR   TABDRIVE
         00002d80     0080  
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   13

     538 00002d90 00002de0'         .LONG   DCATAB,DIAG_CRAM+010H
     539 00002dd0     0002          .WORD   2
     540 00002de0     001c  DCATAB  .WORD   001CH,001CH,011CH,021CH,031CH,039CH,239CH,2390H,2388H
     541 00002e70     2380          .WORD   2380H,4300H,5280H,7180H,6180H,7080H,7000H,6000H,5000H
     542 00002f00     4000          .WORD   4000H,3000H,2000H,1000H,0FFFFH
     543 00002f50     0d3f  BPR     CALLR   TABDRIVE
         00002f60     0062  
     544 00002f70 00002fc0'         .LONG   BPRTAB,DIAG_CRAM
     545 00002fb0     0001          .WORD   1
     546 00002fc0     001c  BPRTAB  .WORD   001CH,101CH,201CH,301CH,401CH,501CH,601CH,701CH,7010H
     547 00003050     7010          .WORD   7010H,7008H,7008H,7000H,7000H,7008H,7008H,7010H,7010H
     548 000030e0     701c          .WORD   701CH,701CH,601CH,501CH,401CH,301CH,201CH,101CH,0FFFFH
     549                    
     550 00003170     09c0  LFLASH  MOVI    07FFFH,A0
         00003180     7fff  
     551 00003190     0580          MOVE    A0,@DIAG_CRAM+20H,W
         000031a0 00000100- 
     552 000031c0                   SLEEPK  2
     553 00003200           LFLASH1
     554 00003200     05a0          MOVE    @RAND,A0,W
         00003210 00000000! 
     555 00003230     0b80          ANDI    0000001FH,A0
         00003240 ffffffe0  
     556 00003260     09e1          MOVI    COLTAB,A1
         00003270 00003340' 
     557 00003290     2480          SLL     4,A0
     558 000032a0     4001          ADD     A0,A1
     559 000032b0     8421          MOVE    *A1,A1,W
     560 000032c0     0581          MOVE    A1,@DIAG_CRAM+020H,W
         000032d0 00000100- 
     561 000032f0                   SLEEPK  6
     562 00003330     c0e3          JRUC    LFLASH
     563                    
     564 00003340     0380  COLTAB  .WORD   0380H,1380H,2380H,3380H,4380H,5380H,6380H,7380H,7300H
     565 000033d0     7280          .WORD   7280H,7200H,7180H,7080H,7008H,7008H,7010H,7010H,701CH
     566 00003460     701c          .WORD   701CH,601CH,501CH,409CH,309CH,209CH,219CH,029CH,039CH
     567 000034f0     139c          .WORD   139CH,239CH,339CH,539CH,739CH,7390H,7380H,6380H,4380H
     568 00003580     ffff          .WORD   0FFFFH
     569                    
     570 00003590           TABDRIVE
     571 00003590     97e0          MOVE    *SP+,A0,L
     572 000035a0     960b          MOVE    *A0+,A11,L      ;A11 = TABLE START
     573 000035b0     9609          MOVE    *A0+,A9,L       ;A9 = LOCATION TO STUFF COLOR
     574 000035c0     840a          MOVE    *A0,A10,W       ;A10 = SLEEP TIME
     575 000035d0           TABDRV1
     576 000035d0     4d68          MOVE    A11,A8          ;RESET TO START OF TABLE
     577 000035e0           TABDRV2
     578 000035e0     9500          MOVE    *A8+,A0,W       ;GET A COLOR
     579 000035f0     cefd          JRN     TABDRV1         ;BR = END OF TABLE
     580 00003600     8009          MOVE    A0,*A9,W
     581 00003610     4d40          MOVE    A10,A0
     582 00003620     09e7          MOVI    TABDRV2,A7
         00003630 000035e0' 
     583 00003650     c080          JAUC    PRCLSP          ;LOOP SLEEP
         00003660 00000000! 
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   14

     584                    
     585 00003680           PC_TRANSFER
     586 00003680     09e0          MOVI    DIAG_CRAM,A0
         00003690 000000e0- 
     587 000036b0     09c1          MOVI    DIAG_CYCLE_COLOR_START,A1
         000036c0     003c  
     588 000036d0     09c2          MOVI    NUM_DIAG_CYCLE_COLORS,A2
         000036e0     0004  
     589 000036f0     0d5f          CALLA   pal_set
         00003700 00000000! 
     590 00003720                   SLOOP   1,PC_TRANSFER
     591                    
     592 00003790           CHK_CMOS
     593 00003790     0d3f          CALLR   DIGSRT      ;CLEAR OUT THE SCREEN...(MESSAGE WILL FOLLOW!)
         000037a0     fee3  
     594 000037b0     0d5f          CALLA   CMOS_VAL
         000037c0 00000000! 
     595 000037e0     cb13          JRNZ    FAC_TIME
     596 000037f0     09e2          MOVI    MESS_BITCHIN,A2          ;POINT AT DATA
         00003800 00009ce0' 
     597 00003820     09c3          MOVI    ROBO_WHITE,A3
         00003830     0202  
     598 00003840                   JSRP    TOP_BOX
     599 000038b0                   SLEEPK  18H
     600 000038f0                   RETP
     601 00003920           FAC_TIME:
     602 00003920                   JSRP    GET_FAC                   ;GET THE GAME TO FACTORY SETTINGS!
     603 00003990     0d5f          CALLA   CLR_SCRN                  ;PRESSED....BLANK THE SCREEN AND
         000039a0 00000000! 
     604                                                               ;HOLD TILL HE LETS GO.
     605 000039c0     c080          JAUC     WARMSET              ;CMOS IS OK....RETURN!
         000039d0 00000000! 
     606                    
     607 000039f0           GET_FAC
     608                    
     609 000039f0           FAC_LOOP
     610 000039f0     0d5f          CALLA   CLR_SCRN                ;CLEAR SCREEN IN ANTICIPATION OF MESSAGE
         00003a00 00000000! 
     611 00003a20     5600          clr     a0                      ;Full
     612 00003a30     0d5f          CALLA   FAC_SET
         00003a40 00000000! 
     613 00003a60     0d5f          CALLA   CMOS_VAL                ;IS IT OK NOW?
         00003a70 00000000! 
     614 00003a90     ca0b          JRZ     CMOS_FIXED              ;YEP....FINISH CLEANUP!
     615                    
     616 00003aa0     09e8          MOVI    MESS_FAIL,A8            ;POINT AT DATA
         00003ab0 000098b0' 
     617 00003ad0                   JSRP    L_MESS                  ;DISPLAY LARRY MESSAGE
     618                    
     619 00003b40     c00f          JRUC    WAIT_POINT              ;WE'RE DEAD..ADVANCE TAKES US TO TEST MODE!
     620                    
     621 00003b50           CMOS_FIXED
     622 00003b50     0d3f          CALLR   CENT_BOX                ;PUT A BOX AROUND IT
         00003b60     0588  
     623                    
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   15

     624 00003b70     09e8          MOVI    MESS_FAC,A8             ;POINT AT DATA
         00003b80 00000000! 
     625 00003ba0                   JSRP    L_MESS                  ;DISPLAY LARRY MESSAGE
     626                    
     627                    
     628 00003c10     0d5f          CALLA   FAC_STUF                ;DO REST OF FULL FACTORY STUFF!
         00003c20 00000000! 
     629                    
     630                    
     631 00003c40           WAIT_POINT
     632 00003c40                   RETP                            ;NOW LET CALLER TAKE OVER.
     633                    
     634                    
     635              0100  MEN_OFF   EQU     PDATA                ;WORD-OFFSET INTO MENU OF SELECTION
     636              0110  MEN_ROUT  EQU     MEN_OFF+WORD_SIZE    ;LONG-ROUTINE FOR SELECTION
     637              0130  MEN_ROM   EQU     MEN_ROUT+LONG_SIZE   ;LONG-POINTER TO ROM STRUCTURE
     638              0150  MEN_ULX   EQU     MEN_ROM+LONG_SIZE    ;WORD-LEFT X  (CENTER X WHEN CENTERING)
     639              0160  MEN_ULY   EQU     MEN_ULX+WORD_SIZE    ;WORD-TOP Y
     640              0170  MEN_DY    EQU     MEN_ULY+WORD_SIZE    ;WORD-Y UNITS PER ENTRY
     641              0180  MEN_COLR  EQU     MEN_DY+WORD_SIZE     ;WORD-COLOR FOR ENTRIES
     642              0190  MEN_BAR   EQU     MEN_COLR+WORD_SIZE   ;WORD-HEIGHT OF SELECTION BAR
     643              01a0  MEN_BDY   EQU     MEN_BAR+WORD_SIZE    ;WORD-DY FROM TOP OF TEXT TO TOP OF BAR.
     644              01b0  MEN_BDX   EQU     MEN_BDY+WORD_SIZE    ;WORD-DX FROM LEFT OF WORD TO LEFT OF BAR
     645              01c0  MEN_BWID  EQU     MEN_BDX+WORD_SIZE    ;WORD-WIDTH OF BAR
     646              01d0  MEN_SCOL  EQU     MEN_BWID+WORD_SIZE   ;WORD-COLOR OF SELECTED TEXT
     647              01e0  MEN_TPTR  EQU     MEN_SCOL+WORD_SIZE    ;LONG-POINTER TO BEGINNING OF TEXT ENTRIES.
     648              0200  MEN_ENTS  EQU     MEN_TPTR+LONG_SIZE   ;WORD-NUMBER OF ENTRIES IN MENU
     649              0210  MEN_CUR   EQU     MEN_ENTS+WORD_SIZE   ;WORD-CURRENT SELECTION (1ST IS 1)
     650              0220  MEN_WALK  EQU     MEN_CUR+WORD_SIZE    ;WORD-NUMBER OF ENTRY WE'RE ON AS WE WALK
     651              0230  MEN_STIK  EQU     MEN_WALK+WORD_SIZE   ;LONG-"STUCK" STATE OF SWITCHES
     652              0250  MEN_ACT   EQU     MEN_STIK+LONG_SIZE   ;LONG-SWITCH WE'RE ACTING ON. (BIT)
     653              0270  MEN_TYPO  EQU     MEN_ACT+LONG_SIZE    ;WORD-TYPOMATIC COUNTER
     654              0280  MEN_HITS  EQU     MEN_TYPO+WORD_SIZE   ;WORD-CONSECUTIVE TYPOMATIC HITS
     655              0290  MEN_ADV   EQU     MEN_HITS+WORD_SIZE   ;WORD-NON-ZERO IF ADVANCE WAS BUTTON USED
     656                    
     657              0009  WORD_ENTS    EQU    (MEN_TPTR-MEN_ULX)/WORD_SIZE   ;NUMBER OF WORD ENTRIES
     658                    
     659 00003c70           B_MENU: 
     660 00003c70     09e7          MOVI    BD_SLAVE,A7
         00003c80 00003f20' 
     661 00003ca0     c003          JRUC    GMJMP
     662                    
     663 00003cb0           GET_MENU:
     664 00003cb0     09e7          MOVI    GM_SLAVE,A7             ;THIS IS ROUTINE
         00003cc0 00003f40' 
     665 00003ce0           GMJMP:
     666 00003ce0     09c1          MOVI    MENU_PID,A1             ;THIS IS ID
         00003cf0     0ac1  
     667 00003d00     0d5f          CALLA   GETPRC                  ;CREATE IT
         00003d10 00000000! 
     668                    
     669 00003d30     4c0a          MOVE    A0,A10                  ;SAVE HIS POINTER
     670                    
     671 00003d40           GM1:    
     672 00003d40                   SLEEPK  2
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   16

     673                    
     674 00003d80     09c0          MOVI    MDUN_PID,A0
         00003d90     0ac2  
     675 00003da0     09e1          MOVI    0FFFFH,A1
         00003db0 0000ffff  
     676 00003dd0     0d5f          CALLA   EXISTP                  ;WAIT FOR ID TO CHANGE TO THIS!
         00003de0 00000000! 
     677                    
     678 00003e00     caf3          JRZ     GM1                     ;LOOP UNTIL IT EXISTS!
     679                    
     680 00003e10     b548          MOVE    *A10(MEN_OFF),A8        ;RETURN OFFSET OF SELECTION
         00003e20     0100  
     681 00003e30     b749          MOVE    *A10(MEN_ROUT),A9,L     ;AND ROUTINE THAT WAS SELECTED.
         00003e40     0110  
     682 00003e50     b54a          MOVE    *A10(MEN_ADV),A10       ;INDICATE WHETHER ADVANCE WAS USED
         00003e60     0290  
     683                    
     684 00003e70     09c0          MOVI    MDUN_PID,A0
         00003e80     0ac2  
     685 00003e90     09e1          MOVI    0FFFFH,A1
         00003ea0 0000ffff  
     686 00003ec0     0d5f          CALLA   KILALL                  ;KILL THE HANGING MENU GETTER!
         00003ed0 00000000! 
     687 00003ef0                   RETP                            ;AND RETURN
     688                    
     689                            
     690 00003f20           BD_SLAVE
     691 00003f20     0d3f          CALLR   MENU_BORDER          ;DRAW THE BORDER FOR SELCTIONS.
         00003f30     0382  
     692                    
     693 00003f40           GM_SLAVE
     694 00003f40                   JSRP    ST_STICK          ;TELL STICK(S) AND BUTTONS WE'RE STARTING.
     695                    
     696 00003fb0     0d3f          CALLR   STUFF_MENU_PROCESS   ;MOVE DATA INTO PDATA AREA
         00003fc0     01c9  
     697                    
     698                    
     699 00003fd0     1820          MOVK    1,A0                        ;SETUP FOR LINE 1.
     700                    
     701 00003fe0           DO_ANOTHER_LINE
     702                    
     703 00003fe0     b00d          MOVE    A0,*A13(MEN_WALK),W       ;WALK THROUGH.
         00003ff0     0220  
     704                    
     705 00004000                   JSRP    DO_MENU_LINE              ;PUT OUT LINE IN A0.
     706 00004070     b5a0          MOVE    *A13(MEN_WALK),A0,W       ;GET BACK THE COUNTER
         00004080     0220  
     707                    
     708 00004090     1020          INC     A0                        ;MOVE TO NEXT ENTRY.
     709 000040a0     b5a1          MOVE    *A13(MEN_ENTS),A1,W       ;SEE IF WE'RE DONE.
         000040b0     0200  
     710 000040c0     4820          CMP     A1,A0
     711 000040d0     c2f0          JRLS    DO_ANOTHER_LINE
     712 000040e0     0d3f          CALLR   PLOT_HELP                 ;PLOT HELP FOR 1ST IF NECESSARY
         000040f0     0349  
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   17

     713                    
     714                    
     715 00004100           MENU_LOOP
     716 00004100                   SLEEPK  1
     717 00004140     0d5f          calla   READ_DIP                ;Get the current dip switch bits
         00004150 00000000! 
     718 00004170     1f00          btst    DPTEST_B,a0
     719 00004180     0300          jrnz    emtmdipon
     720                    
     721 00004190           emtmdipon
     722 00004190     09e5          MOVI    MENU_TYPO,A5
         000041a0 0004000e  
     723 000041c0                   JSRP    GETSTICK                ;ASK THE STICK HANDLER.......
     724 00004230     4c00          MOVE    A0,A0                   ;SEE WHAT GET_STICK RETURNED.
     725 00004240     caeb          JRZ     MENU_LOOP               ;MENU...(PAUSE)  NOTHING.
     726                    
     727 00004250     b5a1          MOVE    *A13(MEN_CUR),A1,W      ;GET CURRENT ENTRY...IN A1
         00004260     0210  
     728                    
     729 00004270     0b40          CMPI    3,A0                    ;BUTTON?
         00004280     fffc  
     730 00004290     ca35          JRZ     MENU_BUTTON             ;YEP....WE'RE OUT OF HERE.
     731                    
     732 000042a0     0b40          CMPI    2,A0
         000042b0     fffd  
     733 000042c0     ca0e          JRZ     MENU_DOWN               ;ITS DOWN....
     734 000042d0     0b41          CMPI    1,A1                    ;WELL?
         000042e0     fffe  
     735 000042f0     c2e0          JRLS    MENU_LOOP               ;YEP....IGNORE
     736                    
     737 00004300                   JSRP    UN_SELECT               ;PUT BACK THE OLD "CURRENT ONE
     738 00004370     b5a0          MOVE    *A13(MEN_CUR),A0,W      ;GET CURRENT ENTRY
         00004380     0210  
     739 00004390     1420          DEC     A0                      ;MAKE ONE LESS.
     740 000043a0     c00e          JRUC    JOIN_DOWN               ;NOW PLOT THE NEW ONE.
     741                    
     742 000043b0           MENU_DOWN:
     743 000043b0     b5a2          MOVE    *A13(MEN_ENTS),A2,W     ;GET NUMBER IN MENU
         000043c0     0200  
     744 000043d0     4841          CMP     A2,A1                   ;ARE WE AT MAX
     745 000043e0     c9d1          JRHS    MENU_LOOP               ;YEP...NO ACTION
     746                    
     747 000043f0                   JSRP    UN_SELECT               ;PUT BACK THE OLD "CURRENT ONE
     748                    
     749 00004460     b5a0          MOVE    *A13(MEN_CUR),A0,W      ;GET CURRENT ENTRY
         00004470     0210  
     750 00004480     1020          INC     A0                      ;MAKE THIS THE NEXT.
     751                    
     752 00004490           JOIN_DOWN:
     753 00004490     b00d          MOVE    A0,*A13(MEN_CUR),W      ;PUT BACK
         000044a0     0210  
     754 000044b0                   JSRP    DO_MENU_LINE            ;PUT OUT LINE IN A0.
     755 00004520     0d3f          CALLR   PLOT_HELP               ;PLOT HELP NEW ONE
         00004530     0305  
     756 00004540                   SLEEPK  1                       ;DELAY BEEP 1 FRAME
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   18

     757 00004580                   SOUND1  beep1_snd
     758 000045e0     c0b1          JRUC    MENU_LOOP               ;AND WAIT FOR NEXT RESPONSE.
     759                    
     760 000045f0           MENU_BUTTON:
     761 000045f0     b7a0          MOVE    *A13(MEN_ROM),A0,L
         00004600     0130  
     762 00004610     0b60          CMPI    MEN_ADJ,A0              ; SPECIAL CASE FOR MENU ADJ
         00004620 ffffffff! 
     763 00004640     cb16          JRNZ    MBNOTADJ
     764 00004650     0d5f          CALLA   CKDIP
         00004660 00000000! 
     765 00004680     cb12          JRNZ    MBNOTADJ                ; NOT USING DIP SWITCHES
     766 00004690     b5a0          MOVE    *A13(MEN_CUR),A0,W      ; GET THE SELECT ITEM
         000046a0     0210  
     767 000046b0     0b40          CMPI    2,A0                    ; "STANDARD PRICING"
         000046c0     fffd  
     768 000046d0     ca06          JRZ     MBABORT
     769 000046e0     0b40          CMPI    3,A0                    ; "CUSTOM PRICING"
         000046f0     fffc  
     770 00004700     ca03          JRZ     MBABORT
     771 00004710     0b40          CMPI    4,A0                    ; "FREE PLAY"
         00004720     fffb  
     772 00004730     cb07          JRNZ    MBNOTADJ
     773 00004740           MBABORT
     774                    
     775 00004740                   SOUND1  UHOH
     776 000047a0     c095          JRUC    MENU_LOOP
     777 000047b0           MBNOTADJ
     778 000047b0     5600          CLR     A0                      ;NOT ADVANCE
     779                    
     780 000047c0           IS_ADV: 
     781 000047c0     b00d          MOVE    A0,*A13(MEN_ADV),W      ;NON ZERO IF IT WAS ADVANCE
         000047d0     0290  
     782                    
     783 000047e0                   JSRP    BUTTON_STALL            ;HIGHLIGHT SELECTION AND HANG ON BUTTON
     784                    
     785 00004850     b5a0          MOVE    *A13(MEN_CUR),A0,W      ;GET "CURRENT" ENTRY.
         00004860     0210  
     786 00004870     0d3f          CALLR   GET_MENU_DATA           ;A1=CURRENT_OFFSET  A2=TEXT  A3=ROUTINE
         00004880     02b7  
     787 00004890     b00d          MOVE    A0,*A13(MEN_OFF),W      ;STORE THE OFFSET (CHOICE NUM)
         000048a0     0100  
     788 000048b0     b26d          MOVE    A3,*A13(MEN_ROUT),L     ;AND THE ROUTINE POINTER
         000048c0     0110  
     789 000048d0     09c0          MOVI    MDUN_PID,A0
         000048e0     0ac2  
     790 000048f0     b00d          MOVE    A0,*A13(PROCID),W       ;CHANGE OUR ID.
         00004900     0020  
     791                    
     792 00004910           MENU_DONE:
     793 00004910                   SLEEPK  20
     794 00004950     c0fb          JRUC    MENU_DONE               ;NOW HANG TILL DISPATCHER SEES ID.
     795                    
     796 00004960           BUTTON_STALL:
     797 00004960     0782          MOVE    A2,@LAST_BUT,L       ;PUSH THE BUTTON STATE
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   19

         00004970 00000040- 
     798                    
     799 00004990     05a0          MOVE    @SCODE,A0,W          ;NO CASH FOR REPEAT SOUND CODES
         000049a0 00000000! 
     800 000049c0     05a1          MOVE    @DCODE,A1,W
         000049d0 00000000! 
     801 000049f0     5401          OR      A0,A1
     802 00004a00     cb2d          JRNZ    DONT_WAIT            ;ITS A SOUND REPEAT....DON'T HOLD EITHER!
     803                    
     804 00004a10                   SOUND1  SELECT_SND            ;MAKE SELECT SOUND
     805                    
     806 00004a70     b5a0          MOVE    *A13(MEN_CUR),A0,W   ;GET CURRENT SELECTION
         00004a80     0210  
     807 00004a90     09c1          MOVI    COLOR_YELLOW,A1
         00004aa0     0505  
     808 00004ab0     0d3f          CALLR   MENU_BAR             ;CHANGE THE BAR COLOR.
         00004ac0     0170  
     809                    
     810 00004ad0     0d3f          CALLR   GET_MENU_DATA             ;GET OUR TEXT POINTER BACK
         00004ae0     0291  
     811 00004af0     09c1          MOVI    ROBO_WHITE,A1            ;WHITE ON ORANGE DURING HOT MOMENT
         00004b00     0202  
     812 00004b10                   JSRP    MENU_TEXT                 ;AND WRITE INVERTED TEXT
     813                    
     814 00004b80     07a8          MOVE    @LAST_BUT,A8,L            ;GET BUTTON BACK
         00004b90 00000040- 
     815 00004bb0     09c9          MOVI    08H,A9                    ;MINIMUM TIME FOR BUTTON HIGHLITE
         00004bc0     0008  
     816                    
     817 00004bd0           WAIT_FOR_RELEASE:
     818                    
     819                    
     820 00004bd0                   SLEEPK  1
     821                            
     822 00004c10     4d29          MOVE    A9,A9                ;REDUCE FOR HELD TIME
     823 00004c20     ca01          JRZ     WAIT_1               ;ZEROED OUT ALREADY.
     824 00004c30     1429          DEC     A9
     825                    
     826 00004c40           WAIT_1:
     827 00004c40     0d3f          CALLR   FORM_SWS        ;WAIT FOR THIS ONE TO GO TO ZERO
         00004c50     0210  
     828 00004c60     5100          AND     A8,A0                ;IS OUR BUTTON STILL DOWN?
     829 00004c70     cbf5          JRNZ    WAIT_FOR_RELEASE
     830                    
     831 00004c80     1029          INC     A9                   ;MAKE SURE A9 HAS 1 OR MORE
     832 00004c90           WAIT_2:
     833 00004c90                   SLEEPK  1
     834 00004cd0     3ca9          DSJS    A9,WAIT_2
     835                    
     836 00004ce0           DONT_WAIT:
     837 00004ce0     b5a0          MOVE    *A13(MEN_CUR),A0,W   ;GET CURRENT SELECTION
         00004cf0     0210  
     838 00004d00     5621          CLR     A1                   ;ERASE BAR
     839 00004d10     0d3f          CALLR   MENU_BAR             ;CHANGE THE BAR COLOR.
         00004d20     014a  
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   20

     840                    
     841 00004d30     0d3f          CALLR   GET_MENU_DATA             ;GET OUR TEXT POINTER BACK
         00004d40     026b  
     842 00004d50     b5a1          MOVE    *A13(MEN_COLR),A1,W       ;RE-PLOT THE NORMAL TEXT
         00004d60     0180  
     843 00004d70                   JSRP    MENU_TEXT               
     844                    
     845 00004de0                   SLEEPK  2                    ;NOW GIVE SOME BOUNCE PROTECTION.
     846                    
     847 00004e20                   RETP
     848                    
     849 00004e50       4e          .STRING "NNBBAA  JJAAMM  --  CCOOPPYYRRIIGGHHTT  11999933  "
     850 00004fe0       4d          .STRING "MMIIDDWWAAYY  MMAANNUUFFAACCTTUURRIINNGG  CCOOMMPPAANNYY..  "
     851 000051c0       41          .STRING "AALLLL  RRIIGGHHTTSS  RREESSEERRVVEEDD..  "
     852 00005310       44          .STRING "DDEESSIIGGNNEEDD  BBYY::  MMAARRKK  TTUURRMMEELLLL  "
     853 000054b0       53          .STRING "SSHHAAWWNN  LLIIPPTTAAKK  TTOONNYY  GGOOSSKKIIEE  "
     854 00005640       4a          .STRING "JJOOHHNN  CCAARRLLTTOONN  SSAALL  DDIIVVIITTAA  "
     855 000057c0       4a          .STRING "JJOOHHNN  HHEEYY  AANNDD  JJAAMMIIEE  RRIIVVEETTTT..  "
     856 00005970       53          .STRING "SSPPEECCIIAALL  TTHHAANNKKSS  TTOO::  LLIINNDDAA  DDEEAALL  "
     857 00005b50       41          .STRING "AANNDD  GGEEOORRGGEE  PPEETTRROO.."
     858 00005c60                   .even
     859                    
     860 00005c60           STUFF_MENU_PROCESS:
     861 00005c60     098f          MMTM    SP,A0,A1,A2,A3,A8
         00005c70     f080  
     862 00005c80     4da0          MOVE    A13,A0               ;POINT IN PROCESS AREA
     863 00005c90     0b00          ADDI    MEN_ROM,A0           ;THIS IS WHERE 1ST TIDBIT GOES
         00005ca0     0130  
     864 00005cb0     9300          MOVE    A8,*A0+,L            ;STORE OUR BASE POINTER IN STRUCTURE
     865 00005cc0     0b08          ADDI    MR_WORDS,A8          ;MOVE TO WORD LIST
         00005cd0     0070  
     866                    
     867 00005ce0     09c2          MOVI    WORD_ENTS,A2         ;NOW THIS MANY MORE WORDS.
         00005cf0     0009  
     868                    
     869 00005d00           GMS1:   
     870 00005d00     9501          MOVE    *A8+,A1
     871 00005d10     9020          MOVE    A1,*A0+
     872 00005d20     3c62          DSJS    A2,GMS1
     873 00005d30     b30d          MOVE    A8,*A13(MEN_TPTR),L  ;STORE IN PROCESS AREA.
         00005d40     01e0  
     874 00005d50     5600          CLR     A0                        ;START AT emtm1.
     875 00005d60           HOW_MANY:
     876 00005d60     1020          INC     A0                        ;MOVE TO NEXT ENTRY.
     877 00005d70     0d3f          CALLR   GET_MENU_DATA             ;GET THE PARAMETERS FOR THIS ENTRY
         00005d80     0167  
     878 00005d90     4c42          MOVE    A2,A2                     ;AND SEE IF A2=0
     879 00005da0     cbfb          JRNZ    HOW_MANY                  ;ITS REAL.....PUT IT UP.
     880                    
     881 00005db0     1420          DEC     A0                        ;PREVIOUS LINE WAS THE LAST.
     882 00005dc0     b00d          MOVE    A0,*A13(MEN_ENTS),W       ;STUFF NUMBER IN MENU.
         00005dd0     0200  
     883                    
     884 00005de0     4d29          MOVE    A9,A9                     ;DID BOZO PASS ZERO AS CURRENT?
     885 00005df0     ca03          JRZ     USE_LAST
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   21

     886 00005e00     4809          CMP     A0,A9                     ;MAKE SURE ITS NOT TOO HIGH
     887 00005e10     c301          JRHI    USE_LAST                  ;A9 IS TOO HIGH
     888 00005e20     4d20          MOVE    A9,A0                     ;USE THE ONE PAST
     889                    
     890 00005e30           USE_LAST:
     891 00005e30     b00d          MOVE    A0,*A13(MEN_CUR),W   ;MAKE ENTRY "1" CURRENT.
         00005e40     0210  
     892 00005e50     09af          MMFM    SP,A0,A1,A2,A3,A8
         00005e60     010f  
     893 00005e70     0960          RETS
     894                    
     895 00005e80           DO_MENU_LINE:
     896 00005e80     0d3f          CALLR   GET_MENU_DATA             ;GET "CURRENT" IN A1
         00005e90     0156  
     897 00005ea0     4801          CMP     A0,A1                     ;IS IT "CURRENT" ENTRY?
     898 00005eb0     ca0c          JRZ     DO_CURRENT_ENT            ;YEP....DO INVERSE STUFF
     899 00005ec0     b5a1          MOVE    *A13(MEN_COLR),A1,W       ;USE THE NORMAL ENTRY COLOR
         00005ed0     0180  
     900 00005ee0                   JSRP    MENU_TEXT                 ;PUT UP THE "TEXT" PORTION.
     901 00005f50                   RETP                              ;AND RETURN
     902                    
     903 00005f80           DO_CURRENT_ENT: 
     904 00005f80     09c1          MOVI    ROBO_WHITE,A1            ;DO THE BAR IN WHITE (AT A0 HEIGHT)
         00005f90     0202  
     905 00005fa0     0d3f          CALLR   MENU_BAR                  ;PUT IT UP (A0 PRESERVED)
         00005fb0     0021  
     906                    
     907 00005fc0     0d3f          CALLR   GET_MENU_DATA             ;GET OUR TEXT POINTER BACK
         00005fd0     0142  
     908 00005fe0     b5a1          MOVE    *A13(MEN_SCOL),A1,W       ;GET "SELECTED" COLOR
         00005ff0     01d0  
     909 00006000                   JSRP    MENU_TEXT                 ;AND WRITE INVERTED TEXT
     910 00006070                   RETP                              ;THAT'S ALL FOLKS.
     911                    
     912 000060a0           UN_SELECT:
     913 000060a0     b5a0          MOVE    *A13(MEN_CUR),A0,W        ;POINT AT CURRENT ENTRY
         000060b0     0210  
     914 000060c0     5621          CLR     A1                        ;USE BLACK FOR BACKGROUND
     915 000060d0     0d3f          CALLR   MENU_BAR                  ;THIS REMOVES THE BAR.
         000060e0     000e  
     916                    
     917 000060f0     0d3f          CALLR   GET_MENU_DATA             ;NOW GET A2 TO TEXT POINTER
         00006100     012f  
     918 00006110     b5a1          MOVE    *A13(MEN_COLR),A1,W       ;USE THE NORMAL ENTRY COLOR
         00006120     0180  
     919 00006130                   JSRP    MENU_TEXT                 ;PUT UP THE "TEXT" PORTION.
     920 000061a0                   RETP                              ;AND RETURN
     921                    
     922 000061d0           MENU_BAR:
     923 000061d0     098f          MMTM    SP,A0,A1,A3,A4,A5,A6,A7,A8    ;SAVE THE OFFSET
         000061e0     df80  
     924 000061f0     098f          MMTM    SP,A1                     ;SAVE COLOR!
         00006200     4000  
     925 00006210     0d3f          CALLR   GET_MENU_DATA             ;GET THE TEXT POINTER
         00006220     011d  
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   22

     926 00006230     0d3f          CALLR   STLEN_SETUP               ;SETUP FOR STRLEN CALL.
         00006240     003d  
     927 00006250     0d5f          CALLA   STRNGLEN                  ;FIND WIDTH OF STRING.
         00006260 00000000! 
     928 00006280     b5a3          MOVE    *A13(MEN_ULX),A3,W        ;LEFT X IN A3                 
         00006290     0150  
     929 000062a0     b7a6          MOVE    *A13(MEN_ROM),A6,L        ;GET ROM POINTER
         000062b0     0130  
     930 000062c0     b6c6          MOVE    *A6(MR_TCAL),A6,L         ;CHECK ROUTINE
         000062d0     0020  
     931 000062e0     0b66          CMPI    STRCNRM,A6
         000062f0 ffffffff! 
     932 00006310     cb06          JRNZ    NOT_CENTERING
     933 00006320     b5a7          MOVE    *A13(MEN_BWID),A7,W       ;A7 IS THE REGISTER FOR BAR WIDTH
         00006330     01c0  
     934 00006340     4ce4          MOVE    A7,A4                     ;GET COPY IN A4
     935 00006350     2fe4          SRL     1,A4                      ;1/2 OF WIDTH COMES OFF OF CENTER
     936 00006360     4483          SUB     A4,A3                     ;A3 NOW HAS "LEFT X"
     937 00006370     c005          JRUC    CENTERING                 ;A7 IS WIDTH...A3 IS X
     938                    
     939 00006380           NOT_CENTERING:
     940 00006380     b5a4          MOVE    *A13(MEN_BDX),A4,W        ;GET EXTRA X UNITS FOR BAR
         00006390     01b0  
     941 000063a0     4483          SUB     A4,A3
     942                    
     943 000063b0     2424          SLL     1,A4                      ;NOW DOUBLE THE EXCESS DX FOR BAR
     944 000063c0     4087          ADD     A4,A7                     ;NOW A7 HAS WIDTH OF BAR
     945                    
     946 000063d0           CENTERING:
     947 000063d0     0be3          SUBI    C_KLUDGE,A3          ;KLUDGE TO NULLIFY FINAL SPACE.
         000063e0     fffe  
     948                    
     949 000063f0     0d3f          CALLR   GET_ENTRY_Y               ;GET Y FOR ENTRY IN A5
         00006400     0129  
     950                    
     951 00006410     b5a6          MOVE    *A13(MEN_BDY),A6,W        ;GET BAR DY (NEGATIVE)
         00006420     01a0  
     952 00006430     40c5          ADD     A6,A5                     ;ADJUST Y BY BAR DY
     953 00006440     2605          SLL     16,A5                     ;SHIFT Y INTO POSITION
     954                    
     955 00006450     40a3          ADD     A5,A3                     ;A3 NOW POINTS AT UPPER LEFT
     956                    
     957 00006460     b5a4          MOVE    *A13(MEN_BAR),A4,W        ;Y HEIGHT OF BAR
         00006470     0190  
     958 00006480     2604          SLL     16,A4                     ;IN POSITION
     959 00006490     40e4          ADD     A7,A4                     ;A7 HAS X WIDTH OF BAR.
     960                    
     961 000064a0     09af          MMFM    SP,A1                     ;NOW GET COLOR BACK!
         000064b0     0002  
     962 000064c0     2601          SLL     16,A1                     ;SHIFT COLOR TO HIGH HALF (PAL. 0)
     963 000064d0     0d5f          CALLA   FILLAREA                  ;FILL IT UP!
         000064e0 00000000! 
     964                    
     965 00006500     09af          MMFM    SP,A0,A1,A3,A4,A5,A6,A7,A8    ;SAVE THE OFFSET
         00006510     01fb  
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   23

     966 00006520     0960          RETS
     967                    
     968 00006530           MENU_TEXT:
     969 00006530     0d3f          CALLR   GET_ENTRY_Y               ;GET Y FOR ENTRY IN A5
         00006540     0115  
     970 00006550     2605          SLL     16,A5                     ;SHIFT Y INTO POSITION
     971 00006560     b5a9          MOVE    *A13(MEN_ULX),A9,W        ;GET THE X
         00006570     0150  
     972 00006580     40a9          ADD     A5,A9                     ;A9 SET WITH SCREEN ADDRESS
     973                    
     974 00006590     4c26          MOVE    A1,A6                     ;COLOR
     975 000065a0     5600          CLR     A0                        ;NO SLEEP
     976                    
     977 000065b0     0d3f          CALLR   STLEN_SETUP
         000065c0     0005  
     978                    
     979 000065d0     b7a1          MOVE    *A13(MEN_ROM),A1,L
         000065e0     0130  
     980 000065f0     b621          MOVE    *A1(MR_TCAL),A1,L         ;GET THE ROUTINE TO USE
         00006600     0020  
     981 00006610     0161          JUMP    A1                        ;AND CALL IT!
     982                    
     983 00006620           STLEN_SETUP:
     984 00006620     4c48          MOVE    A2,A8                     ;TEXT POINTER
     985 00006630     09ca          MOVI    SPACING20,A10             ;SPACING
         00006640     0002  
     986 00006650     b7ab          MOVE    *A13(MEN_ROM),A11,L
         00006660     0130  
     987 00006670     b76b          MOVE    *A11(MR_FONT),A11,L       ;LOAD FONT
         00006680     0000  
     988 00006690     0960          RETS
     989                    
     990 000066a0           ST_STICK:
     991 000066a0     0d3f          CALLR   FORM_SWS           ;THIS LATCHES ANYONE ALREADY DOWN.
         000066b0     006a  
     992 000066c0     5600          CLR     A0
     993 000066d0     b20d          MOVE    A0,*A13(MEN_ACT),L      ;SHOW THAT WE'RE "ACTING" ON NONE.
         000066e0     0250  
     994 000066f0     b00d          MOVE    A0,*A13(MEN_TYPO),W     ;CLEAR TYPOMATIC COUNTER.
         00006700     0270  
     995 00006710     b00d          MOVE    A0,*A13(MEN_HITS),W     ;CLEAR OUT "CONSECUTIVE HITS"
         00006720     0280  
     996 00006730                   RETP
     997              0303  UP_OR_DOWN       EQU     UP_BITS+DOWN_BITS
     998              0004  TYPO_COUNT       EQU     4
     999              0019  TYPO_STALL       EQU     25
    1000          0004000e  MENU_TYPO        EQU     (TYPO_COUNT*10000H)+14      ;14 HITS FOR MENU TILL STUCK
    1001                            
    1002 00006760           GETSTICK:
    1003 00006760     4ca6          MOVE    A5,A6
    1004 00006770     2e05          SRL     16,A5                ;TYPO RATE IN A5
    1005 00006780     0b86          ANDI    WORD_MASK,A6         ;STUCK HIT COUNT IN A6
         00006790 ffff0000  
    1006                    
    1007 000067b0     0d3f          CALLR   FORM_SWS        ;SEE WHAT THEY LOOK LIKE NOW.
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   24

         000067c0     0059  
    1008 000067d0     03e1          NOT     A1                   ;LAST = 0 AND NOW = 1 MEANS EDGE!
    1009                    
    1010 000067e0     5020          AND     A1,A0                ;1'S WHERE WE HAVE POSITIVE EDGE.
    1011 000067f0     4c04          MOVE    A0,A4                ;KEEP NEW EDGE STATE IN A4!
    1012                    
    1013 00006800     0b80          ANDI    BUTTONS|START_BITS,A0        ;BUTTON SAYS ACT....IGNORE STICK!
         00006810 f9db0f0f  
    1014 00006830     cb3c          JRNZ    TEST_BUTS            ;NEW BUTTON......RETURN IT!
    1015 00006840     b7a2          MOVE    *A13(MEN_ACT),A2,L   ;IS THERE ONE TO WATCH?
         00006850     0250  
    1016 00006860     ca28          JRZ     NEW_SCAN             ;NOPE....LOOK FOR NEW STUFF!
    1017 00006870     0d3f          CALLR   FORM_SWS        ;SEE WHAT THEY LOOK LIKE NOW.
         00006880     004d  
    1018 00006890     5040          AND     A2,A0                ;IS IT STILL MADE?
    1019 000068a0     ca1f          JRZ     GS_STICK_OPEN        ;NOPE.......CLEAR OUT ITS STATE.
    1020 000068b0     b5a1          MOVE    *A13(MEN_TYPO),A1,W  ;DECREMENT TYPOMATIC COUNTER
         000068c0     0270  
    1021 000068d0     1421          DEC     A1
    1022 000068e0     b02d          MOVE    A1,*A13(MEN_TYPO),W  ;AND PUT BACK IN MEMORY
         000068f0     0270  
    1023 00006900     cb35          JRNZ    GS_ZERO              ;NOT TIME YET.....RETURN NOTHING
    1024 00006910     b5a1          MOVE    *A13(MEN_HITS),A1,W  ;GET NUMBER OF HITS
         00006920     0280  
    1025 00006930     1021          INC     A1                   ;AFTER 15 TYPOS.....KILL TILL OPEN!
    1026 00006940     b02d          MOVE    A1,*A13(MEN_HITS)    ;
         00006950     0280  
    1027 00006960     48c1          CMP     A6,A1                ;TOO MANY HITS?
    1028 00006970     c90e          JRHS    GS_GONE              ;YEP....CALL THIS "STUCK"
    1029 00006980     b0ad          MOVE    A5,*A13(MEN_TYPO),W  ;TYPOMATIC COUNTER RELOADED.
         00006990     0270  
    1030                    
    1031 000069a0           RETURN_UP_DOWN:
    1032 000069a0     4c01          MOVE    A0,A1                ;GET THE BIT
    1033 000069b0     4c22          MOVE    A1,A2                ;MAKE A COPY
    1034 000069c0     1820          MOVK    1,A0                 ;ASSUME UP
    1035 000069d0     0b81          ANDI    UP_BITS,A1           ;IS IT AN "UP" BIT
         000069e0 fffffefe  
    1036 00006a00     cb26          JRNZ    GS_X                 ;YEP...RETURN UP.
    1037 00006a10     1840          MOVK    2,A0                 ;ASSUME DOWN
    1038 00006a20     0b82          ANDI    DOWN_BITS,A2         ;IS IT A "DOWN" BIT
         00006a30 fffffdfd  
    1039 00006a50     cb21          JRNZ    GS_X                 ;YEP...RETURN "DOWN"
    1040                    
    1041 00006a60           GS_GONE:
    1042 00006a60     5600          CLR     A0                   ;CLEAR OUT CURRENT HIT.
    1043 00006a70     b20d          MOVE    A0,*A13(MEN_ACT),L   ;INDICATE READY FOR NEXT HIT!
         00006a80     0250  
    1044 00006a90     c01d          JRUC    GS_X                 ;AND RETURN THIS ZERO (NOTHING!)
    1045 00006aa0           GS_STICK_OPEN:
    1046 00006aa0                   SLEEPK  6
    1047 00006ae0     c0f7          JRUC    GS_GONE              ;NOW.....CLEAR OUT FOR NEXT HIT.
    1048 00006af0           NEW_SCAN:
    1049 00006af0     4c80          MOVE    A4,A0                ;LOOK AT THE NEW EDGES.
    1050                    
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   25

    1051 00006b00     0b80          ANDI    UP_OR_DOWN,A0        ;IS IT UP OR DOWN?
         00006b10 fffffcfc  
    1052 00006b30     ca12          JRZ     GS_ZERO              ;NO STICK....RETURN NO ACTION!
    1053                    
    1054 00006b40     0d3f          CALLR   FRST_BIT             ;REDUCE TO ONE BIT.
         00006b50     0014  
    1055 00006b60     b20d          MOVE    A0,*A13(MEN_ACT),L   ;STORE THIS BIT
         00006b70     0250  
    1056                    
    1057 00006b80     09c1          MOVI    TYPO_STALL,A1
         00006b90     0019  
    1058 00006ba0     b02d          MOVE    A1,*A13(MEN_TYPO),W  ;TYPOMATIC COUNTER SET FOR LONG STALL.
         00006bb0     0270  
    1059                    
    1060 00006bc0     5621          CLR     A1
    1061 00006bd0     b02d          MOVE    A1,*A13(MEN_HITS),W  ;LOAD UP A BUNCH OF HITS
         00006be0     0280  
    1062 00006bf0     c0da          JRUC    RETURN_UP_DOWN       ;RETURN CORRECT CODE UP OR DOWN
    1063 00006c00           TEST_BUTS:
    1064 00006c00     0d3f          CALLR   FRST_BIT             ;USE 1 OF THEM.
         00006c10     0008  
    1065                    
    1066 00006c20     4c02          MOVE    A0,A2                ;RETURN THE BIT.
    1067                    
    1068 00006c30     09c0          MOVI    3,A0                 ;RETURN THAT ITS A BUTTON.
         00006c40     0003  
    1069 00006c50     c001          JRUC    GS_X                 ;STUCK PROCESSING WILL BE AUTOMATIC.
    1070                    
    1071 00006c60           GS_ZERO:
    1072 00006c60     5600          CLR     A0                   ;RETURN NO SWITCH.
    1073 00006c70           GS_X:   
    1074 00006c70                   RETP
    1075                    
    1076 00006ca0           FRST_BIT:
    1077 00006ca0     098f          MMTM    SP,A1,A2
         00006cb0     6000  
    1078 00006cc0     1821          MOVK    1,A1            ;SHIFT TILL WE FIND IT.
    1079 00006cd0           FB1:    
    1080 00006cd0     4c02          MOVE    A0,A2
    1081 00006ce0     5022          AND     A1,A2
    1082 00006cf0     cb02          JRNZ    GOT_IT          ;WE HAVE ON (IN A1)
    1083 00006d00     2421          SLL     1,A1            ;SHIFT IT
    1084 00006d10     c0fb          JRUC    FB1
    1085 00006d20           GOT_IT: 
    1086 00006d20     4c20          MOVE    A1,A0           ;RETURN THE BIT
    1087 00006d30     09af          MMFM    SP,A1,A2
         00006d40     0006  
    1088 00006d50     0960          RETS
    1089                    
    1090 00006d60           FORM_SWS:
    1091 00006d60     0d3f          callr   fudge_switches
         00006d70     0005  
    1092                    
    1093 00006d80     b7a1          move    *a13(MEN_STIK),a1,L     ;RETURN PREVIOUS STATE
         00006d90     0230  
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   26

    1094 00006da0     b20d          move    a0,*a13(MEN_STIK),L     ;SAVE "STUCK" STATE.
         00006db0     0230  
    1095 00006dc0     0960          rets
    1096                    
    1097 00006dd0           fudge_switches
    1098                    
    1099 00006dd0     07a0          move    @SWITCH,a0,L            ;GET BOTH SWITCH WORDS
         00006de0 01600000  
    1100 00006e00     03e0          not     a0                      ;COMPLEMENT
    1101                    
    1102 00006e10     05a1          move    @TWOPLAYERS,a1          ;0 = NO, 1 = YES 2 players
         00006e20 00000000! 
    1103 00006e40     cb20          jrnz    emtm2_plyrs
    1104                    
    1105 00006e50     05a1          move    @SWITCH+20h,a1          ;move P3UP & P3DOWN into low 32 bits
         00006e60 01600020  
    1106 00006e80     03e1          not     a1
    1107 00006e90     0b81          andi    011b,a1
         00006ea0 fffffffc  
    1108 00006ec0     5420          or      a1,a0
    1109                    
    1110 00006ed0     05a1          move    @SWITCH+28h,a1          ;move P4UP & P4DOWN into low 32 bits
         00006ee0 01600028  
    1111 00006f00     03e1          not     a1
    1112 00006f10     0b81          andi    011b,a1
         00006f20 fffffffc  
    1113 00006f40     5420          or      a1,a0
    1114                    
    1115 00006f50     05a1          move    @SWITCH+20h,a1          ;move P3 ACTION buttons into low 32 bits
         00006f60 01600020  
    1116 00006f80     03e1          not     a1
    1117 00006f90     0b81          andi    01110000b,a1
         00006fa0 ffffff8f  
    1118 00006fc0     5420          or      a1,a0
    1119                    
    1120 00006fd0     05a1          move    @SWITCH+28h,a1          ;move P4 ACTION buttons into low 32 bits
         00006fe0 01600028  
    1121 00007000     03e1          not     a1
    1122 00007010     0b81          andi    01110000b,a1
         00007020 ffffff8f  
    1123 00007040     5420          or      a1,a0
    1124                    
    1125 00007050           emtm2_plyrs
    1126 00007050     0960          rets
    1127                    
    1128                    
    1129 00007060           fudge_switches_diag
    1130                    
    1131 00007060     07a0          move    @SWITCH,a0,L            ;GET BOTH SWITCH WORDS
         00007070 01600000  
    1132 00007090     03e0          not     a0                      ;COMPLEMENT
    1133                    
    1134 000070a0     05a1          move    @TWOPLAYERS,a1          ;0 = NO, 1 = YES 2 players
         000070b0 00000000! 
    1135 000070d0     cb20          jrnz    emtm2_plyrs2
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   27

    1136                    
    1137 000070e0     05a1          move    @SWITCH+20h,a1          ;move P3UP & P3DOWN into low 32 bits
         000070f0 01600020  
    1138 00007110     03e1          not     a1
    1139 00007120     0b81          andi    011b,a1
         00007130 fffffffc  
    1140 00007150     5420          or      a1,a0
    1141                    
    1142 00007160     05a1          move    @SWITCH+28h,a1          ;move P4UP & P4DOWN into low 32 bits
         00007170 01600028  
    1143 00007190     03e1          not     a1
    1144 000071a0     0b81          andi    011b,a1
         000071b0 fffffffc  
    1145 000071d0     5420          or      a1,a0
    1146                    
    1147 000071e0     05a1          move    @SWITCH+20h,a1          ;move P3 ACTION buttons into low 32 bits
         000071f0 01600020  
    1148 00007210     03e1          not     a1
    1149 00007220     0b81          andi    01110000b,a1
         00007230 ffffff8f  
    1150 00007250     5420          or      a1,a0
    1151                    
    1152 00007260     05a1          move    @SWITCH+28h,a1          ;move P4 ACTION buttons into low 32 bits
         00007270 01600028  
    1153 00007290     03e1          not     a1
    1154 000072a0     0b81          andi    01110000b,a1
         000072b0 ffffff8f  
    1155 000072d0     5420          or      a1,a0
    1156                    
    1157 000072e0           emtm2_plyrs2
    1158 000072e0                   FRET    B6
    1159                    
    1160 000072f0           fudge_switches2
    1161                    
    1162 000072f0     0d3f          callr   fudge_switches
         00007300     ffac  
    1163 00007310     07a1          move    @fswitches_cur,a1,L
         00007320 00000080- 
    1164 00007340     0781          move    a1,@fswitches_last,L
         00007350 000000a0- 
    1165 00007370     0780          move    a0,@fswitches_cur,L
         00007380 00000080- 
    1166 000073a0     5601          xor     a0,a1                   ;bits that have changed
    1167 000073b0     5001          and     a0,a1                   ;down transitions only
    1168 000073c0     0781          move    a1,@fswitches_down,L
         000073d0 000000c0- 
    1169                    
    1170 000073f0     0960          rets
    1171                    
    1172 00007400           GET_MENU_DATA:
    1173 00007400     098f          MMTM    SP,A0                ;DON'T ALTER A0
         00007410     8000  
    1174                    
    1175 00007420     0d3f          CALLR   PM_ENTRY     ;POINT A1 AT ENTRY
         00007430     0009  
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   28

    1176                    
    1177 00007440     b622          MOVE    *A1(MENU_TEXT_PTR),A2,L   ;FETCH THE TEXT POINTER
         00007450     0000  
    1178 00007460     b623          MOVE    *A1(MENU_ROUTINE),A3,L    ;FETCH THE ROUTINE
         00007470     0020  
    1179 00007480     b5a1          MOVE    *A13(MEN_CUR),A1,W        ;RETURN CURRENT ENTRY IN A1
         00007490     0210  
    1180 000074a0     09af          MMFM    SP,A0                ;DON'T ALTER A0
         000074b0     0001  
    1181 000074c0     0960          RETS
    1182                    
    1183 000074d0           PM_ENTRY:
    1184 000074d0     098f          MMTM    SP,A0
         000074e0     8000  
    1185 000074f0     1420          DEC     A0                   ;INDEX FROM ZERO
    1186 00007500     09c1          MOVI    MENU_ENTRY_SIZE,A1   ;TIMES SIZE PER ENTRY
         00007510     0060  
    1187 00007520     5e01          MPYU    A0,A1                ;A1 CONTAINS OFFSET INTO TABLE
    1188                    
    1189 00007530     b7a0          MOVE    *A13(MEN_TPTR),A0,L  ;GET THE BASE OF THE MENU TEXT ENTRIES
         00007540     01e0  
    1190 00007550     4001          ADD     A0,A1                ;ADD TO OFFSET
    1191 00007560     09af          MMFM    SP,A0
         00007570     0001  
    1192 00007580     0960          RETS
    1193                    
    1194 00007590           PLOT_HELP:
    1195 00007590     b5a0          MOVE    *A13(MEN_CUR),A0,W        ;GET CURRENT ENTRY
         000075a0     0210  
    1196 000075b0     0d3f          CALLR   PM_ENTRY          ;A1 POINTS AT GROUP
         000075c0     fff0  
    1197 000075d0     b628          MOVE    *A1(MENU_HELP),A8,L       ;GET HELP TABLE
         000075e0     0040  
    1198 000075f0     0b48          CMPI    NO_HELP,A8                ;NOT A "HELP" SITUATION?
         00007600     fffe  
    1199 00007610     ca07          JRZ     NO_HELP_FOR_THIS_ONE
    1200 00007620     0b48          CMPI    ADJ_HELP,A8               ;ADJUSTMENT HELP REQUESTED?
         00007630     fffd  
    1201 00007640     ca80          JAEQ    DO_ADJH                   ;THEN DO IT IN ADJ MODULE!
         00007650 00000000! 
    1202 00007670     0d3f          CALLR   DO_HELP_MENU
         00007680     00cc  
    1203 00007690           NO_HELP_FOR_THIS_ONE:
    1204 00007690     0960           RETS
    1205                    
    1206 000076a0           GET_ENTRY_Y:
    1207 000076a0     098f          MMTM    SP,A0,A1
         000076b0     c000  
    1208 000076c0     b5a5          MOVE    *A13(MEN_ULY),A5,W
         000076d0     0160  
    1209 000076e0     b5a1          MOVE    *A13(MEN_DY),A1,W
         000076f0     0170  
    1210 00007700     1420          DEC     A0
    1211 00007710     5e01          MPYU    A0,A1                ;A1 HAS OFFSET PER ENTRY
    1212 00007720     4025          ADD     A1,A5
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   29

    1213 00007730     09af          MMFM    SP,A0,A1
         00007740     0003  
    1214 00007750     0960          RETS
    1215                    
    1216 00007760           MENU_BORDER:
    1217 00007760     098f          MMTM    SP,A0,A1,A2,A3,A4,A5,A6,A7,A8,A9
         00007770     ffc0  
    1218 00007780     0d3f          CALLR   STUFF_MENU_PROCESS   ;MOVE DATA INTO PDATA AREA
         00007790     fe4c  
    1219 000077a0     0d3f          CALLR   MENU_UL_A4_A5             ;GET UPPER LEFT COORDINATES
         000077b0     0017  
    1220 000077c0     2605          SLL     16,A5
    1221 000077d0     40a4          ADD     A5,A4                     ;A4 POINTS TO UPPER LEFT.
    1222 000077e0     0d3f          CALLR   MENU_LR_A6_A5
         000077f0     0024  
    1223 00007800     2605          SLL     16,A5                     ;SHIFT A5 DOWN
    1224 00007810     40c5          ADD     A6,A5                     ;A5 POINTS AT LOWER RIGHT
    1225                    
    1226 00007820     b5a9          MOVE    *A13(MEN_COLR),A9,W       ;GET MENU TEXT COLOR
         00007830     0180  
    1227 00007840     0d3f          CALLR   STD_BORD
         00007850     00a4  
    1228                    
    1229 00007860     09af          MMFM    SP,A0,A1,A2,A3,A4,A5,A6,A7,A8,A9
         00007870     03ff  
    1230 00007880     0960          RETS
    1231                    
    1232 00007890           MCSETUP:
    1233 00007890     b5a0          MOVE    *A13(MEN_ULX),A0,W        ;UPPER LEFT X (ACTUALLY CENTER)
         000078a0     0150  
    1234 000078b0     b5a1          MOVE    *A13(MEN_BWID),A1,W       ;BAR_WIDTH
         000078c0     01c0  
    1235 000078d0     2fe1          SRL     1,A1                      ;ALL CALCS USE BAR_WIDTH/2
    1236 000078e0     b5a2          MOVE    *A13(MEN_ULY),A2,W        ;UPPER LEFT Y
         000078f0     0160  
    1237 00007900     b5a3          MOVE    *A13(MEN_BDY),A3,W        ;DELTA Y (NEGATIVE)
         00007910     01a0  
    1238 00007920     0960          RETS
    1239                    
    1240                    
    1241 00007930           MENU_UL_A4_A5:
    1242 00007930     098f          MMTM    SP,A0,A1,A2,A3
         00007940     f000  
    1243 00007950     0d3f          CALLR   MCSETUP                   ;STUFF THE REGGIES
         00007960     fff2  
    1244 00007970     4c04          MOVE    A0,A4                     ;FORM ULX
    1245 00007980     4424          SUB     A1,A4
    1246 00007990     0be4          SUBI    C_KLUDGE,A4          ;A4 HAS UPPER LEFT X
         000079a0     fffe  
    1247                    
    1248 000079b0     4c45          MOVE    A2,A5
    1249 000079c0     4065          ADD     A3,A5                     ;A5 HAS UPPER LEFT Y
    1250                    
    1251 000079d0     0be4          SUBI    MB_XWID+GAP,A4            ;NOW WE POINT AT UPPER LEFT FOR FRAME
         000079e0     fffa  
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   30

    1252 000079f0     0be5          SUBI    MB_YWID+GAP,A5
         00007a00     fffa  
    1253 00007a10     09af          MMFM    SP,A0,A1,A2,A3
         00007a20     000f  
    1254 00007a30     0960          RETS
    1255                    
    1256 00007a40           MENU_LR_A6_A5:
    1257 00007a40     098f          MMTM    SP,A0,A1,A2,A3
         00007a50     f000  
    1258 00007a60     0d3f          CALLR   MCSETUP                   ;STUFF THE REGGIES
         00007a70     ffe1  
    1259                    
    1260 00007a80     4c06          MOVE    A0,A6                     ;LOWER RIGHT X
    1261 00007a90     4026          ADD     A1,A6
    1262 00007aa0     0be6          SUBI    C_KLUDGE,A6          ;THIS IS THE X
         00007ab0     fffe  
    1263                    
    1264 00007ac0     b5a0          MOVE    *A13(MEN_ENTS),A0,W       ;THIS IS LAST ENTRY
         00007ad0     0200  
    1265 00007ae0     0d3f          CALLR   GET_ENTRY_Y               ;A5 HAS THE Y FOR THE LAST ENTRY
         00007af0     ffba  
    1266 00007b00     4065          ADD     A3,A5                     ;A5 NOW HAS TOP OF LAST BOX
    1267 00007b10     b5a7          MOVE    *A13(MEN_BAR),A7,W        ;HEIGHT OF BAR
         00007b20     0190  
    1268 00007b30     40e5          ADD     A7,A5                     ;A5 NOW HAS LOWER RIGHT Y
    1269                    
    1270 00007b40     0b05          ADDI    MB_YWID+GAP,A5
         00007b50     0005  
    1271 00007b60     0b06          ADDI    MB_XWID+GAP,A6            ;THIS IS END OF BORDER
         00007b70     0005  
    1272 00007b80     09af          MMFM    SP,A0,A1,A2,A3
         00007b90     000f  
    1273 00007ba0     0960          RETS
    1274                    
    1275                    
    1276 00007bb0           F_TITLE:
    1277 00007bb0     098f          MMTM    SP,A4,A5,A0
         00007bc0     8c00  
    1278 00007bd0     4c04          MOVE    A0,A4           ;COPY Y
    1279 00007be0     0be4          SUBI    12,A4
         00007bf0     fff3  
    1280 00007c00     2604          SLL     16,A4
    1281 00007c10     0b04          ADDI    TIT_ULX,A4      ;UPPER LEFT SET
         00007c20     0005  
    1282                    
    1283 00007c30     4c05          MOVE    A0,A5           ;LOWER RIGHT
    1284 00007c40     0b05          ADDI    27,A5
         00007c50     001b  
    1285 00007c60     2605          SLL     16,A5
    1286 00007c70     0b05          ADDI    TIT_LRX,A5      ;LOWER RIGHT SET
         00007c80     0185  
    1287                    
    1288 00007c90     0d3f          CALLR   STD_BORD
         00007ca0     005f  
    1289 00007cb0     09af          MMFM    SP,A4,A5,A0
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   31

         00007cc0     0031  
    1290 00007cd0     0960          RETS
    1291                    
    1292              e0e0  FIRST_BORDER_COLOR       EQU     0E0E0H
    1293              efef  LAST_BORDER_COLOR        EQU     0EFEFH
    1294 00007ce0           G_BORDER:
    1295 00007ce0     098f          MMTM    SP,A0,A1,A2,A3,A4,A5,A6
         00007cf0     fe00  
    1296 00007d00     09e0          MOVI    10001H,A0                 ;1 BY 1 DIMENSION
         00007d10 00010001  
    1297                    
    1298 00007d30     09e9          MOVI    LAST_BORDER_COLOR,A9      ;USE LAST ONE 1ST
         00007d40 0000efef  
    1299 00007d60           NEXT_RING:
    1300 00007d60     0d3f          CALLR   DOBORDER                  ;DO THIS RING
         00007d70     0012  
    1301                    
    1302 00007d80     09e1          MOVI    10001H,A1                  ;THIS IS 1 UNIT IN X AND Y
         00007d90 00010001  
    1303 00007db0     e024          ADDXY   A1,A4
    1304 00007dc0     e225          SUBXY   A1,A5
    1305                    
    1306 00007dd0     0be9          SUBI    101H,A9
         00007de0     fefe  
    1307 00007df0     0b69          CMPI    FIRST_BORDER_COLOR,A9
         00007e00 ffff1f1f  
    1308 00007e20     c903          JRHS    COLOK
    1309 00007e30     09e9          MOVI    LAST_BORDER_COLOR,A9
         00007e40 0000efef  
    1310                    
    1311 00007e60           COLOK:  
    1312 00007e60     3e26          DSJS    A6,NEXT_RING
    1313 00007e70     09af          MMFM    SP,A0,A1,A2,A3,A4,A5,A6
         00007e80     007f  
    1314 00007e90     0960          RETS
    1315                    
    1316 00007ea0           DOBORDER:
    1317 00007ea0     098f          MMTM    SP,A0,A1,A2,A3,A4,A5,A6,A7,A8,A9
         00007eb0     ffc0  
    1318 00007ec0     4d21          MOVE    A9,A1                     ;GET COLOR
    1319 00007ed0     2601          SLL     16,A1                     ;COLOR ON TOP..PALETTE 0
    1320 00007ee0     4c02          MOVE    A0,A2                     ;SEPARATE DELTA
    1321 00007ef0     0b80          ANDI    SX_MASK,A0
         00007f00 ffff0000  
    1322 00007f20     0b82          ANDI    SY_MASK,A2
         00007f30 0000ffff  
    1323                    
    1324 00007f50     4c86          MOVE    A4,A6                     ;UPPER LEFTS HERE
    1325 00007f60     4c87          MOVE    A4,A7
    1326                    
    1327 00007f70     4ca8          MOVE    A5,A8                     ;LOWER RIGHTS HERE
    1328 00007f80     4ca9          MOVE    A5,A9
    1329                    
    1330 00007f90     0b86          ANDI    SX_MASK,A6                 ;LEFT X
         00007fa0 ffff0000  
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   32

    1331 00007fc0     0b88          ANDI    SX_MASK,A8                 ;RIGHT X
         00007fd0 ffff0000  
    1332                    
    1333 00007ff0     0b87          ANDI    SY_MASK,A7                 ;TOP Y
         00008000 0000ffff  
    1334 00008020     0b89          ANDI    SY_MASK,A9                 ;BOTTOM Y
         00008030 0000ffff  
    1335                    
    1336 00008050     4c83          MOVE    A4,A3
    1337                    
    1338 00008060     ed04          MOVX    A8,A4
    1339 00008070     eee4          MOVY    A7,A4
    1340 00008080     e044          ADDXY   A2,A4                     ;ADD THE DELTA
    1341                    
    1342 00008090     0d3f          CALLR   DO_A_LINE                 ;DO THIS LINE
         000080a0     0016  
    1343 000080b0     ed03          MOVX    A8,A3
    1344 000080c0     e203          SUBXY   A0,A3
    1345 000080d0     eee3          MOVY    A7,A3
    1346 000080e0     ed04          MOVX    A8,A4
    1347 000080f0     ef24          MOVY    A9,A4
    1348                    
    1349 00008100     0d3f          CALLR   DO_A_LINE
         00008110     000f  
    1350 00008120     ecc3          MOVX    A6,A3
    1351 00008130     ef23          MOVY    A9,A3
    1352 00008140     e243          SUBXY   A2,A3
    1353                    
    1354 00008150     0d3f          CALLR   DO_A_LINE
         00008160     000a  
    1355 00008170     ecc3          MOVX    A6,A3
    1356 00008180     eee3          MOVY    A7,A3
    1357                    
    1358 00008190     ecc4          MOVX    A6,A4
    1359 000081a0     e004          ADDXY   A0,A4
    1360 000081b0     ef24          MOVY    A9,A4
    1361                    
    1362 000081c0     0d3f          CALLR   DO_A_LINE
         000081d0     0003  
    1363                    
    1364 000081e0     09af          MMFM    SP,A0,A1,A2,A3,A4,A5,A6,A7,A8,A9
         000081f0     03ff  
    1365 00008200     0960          RETS
    1366                    
    1367 00008210           DO_A_LINE:
    1368 00008210     098f          MMTM    SP,A4
         00008220     0800  
    1369 00008230     e264          SUBXY   A3,A4           ;FORM DISTANCE
    1370 00008240     0d5f          CALLA   FILLAREA        ;AND DO THE FILL
         00008250 00000000! 
    1371 00008270     09af          MMFM    SP,A4
         00008280     0010  
    1372 00008290     0960          RETS
    1373                    
    1374 000082a0           STD_BORD:
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   33

    1375 000082a0     098f          MMTM    SP,A0
         000082b0     8000  
    1376 000082c0     09e0          MOVI    BORDER_SIZE,A0
         000082d0 00030003  
    1377 000082f0     0d5f          CALLA   DOBORDER
         00008300 00007ea0' 
    1378 00008320     09af          MMFM    SP,A0
         00008330     0001  
    1379 00008340     0960          RETS
    1380 00008350           DO_HELP_MENU:
    1381 00008350     0d3f          CALLR   BLNKHELP
         00008360     0015  
    1382                    
    1383 00008370     4d08          MOVE    A8,A8                ;CHECK IF HELP MENU EXISTS.
    1384 00008380     ca12          JRZ     DHMX                 ;NOPE JUST CLEARING WAS OUR JOB.
    1385                    
    1386 00008390     b5a0          MOVE    *A13(MEN_CUR),A0,W   ;THIS IS CURRENT ENTRY
         000083a0     0210  
    1387 000083b0     4c0b          MOVE    A0,A11               ;PASS ENTRY NUMBER IN A11
    1388 000083c0     0d3f          CALLR   GET_ENTRY_Y          ;A5 HAS THE Y FOR THE CURRENT ENTRY
         000083d0     ff2c  
    1389 000083e0     b5aa          MOVE    *A13(MEN_BDY),A10,W  ;THIS IS NEGATIVE TO GIVE US BOX TOP
         000083f0     01a0  
    1390 00008400     40aa          ADD     A5,A10               ;NOW WE HAVE BOX TOP
    1391                    
    1392 00008410     b5a5          MOVE    *A13(MEN_BAR),A5,W   ;GET BAR HEIGHT
         00008420     0190  
    1393 00008430     2fe5          SRL     1,A5                 ;FIND CENTER OF BAR
    1394 00008440     40aa          ADD     A5,A10               ;NOW WE'RE AT BAR CENTER.
    1395                    
    1396 00008450     09e7          MOVI    H_SLAVE,A7        ;FORK OFF SO IT CAN USE PDATA!
         00008460 00008610' 
    1397 00008480     0d5f          CALLA   P_FORK               ;START UP ANOTHER W/ SAME ID TO FLASH!
         00008490 00000000! 
    1398 000084b0     0960  DHMX    RETS
    1399                    
    1400 000084c0           BLNKHELP:
    1401 000084c0     098f          MMTM    SP,A3,A4,A5,A6
         000084d0     1e00  
    1402 000084e0     0d3f          CALLR   MENU_LR_A6_A5        ;GET RIGHT X OF MAIN MENU IN A6
         000084f0     ff54  
    1403 00008500     4cc9          MOVE    A6,A9                ;PASS TO HELP MENU SLAVE
    1404 00008510     4cc3          MOVE    A6,A3                ;UPPER LEFT X OF REGION TO BLANK OUT
    1405 00008520     0b23          ADDI    INST_ULY*10000H,A3   ;THIS IS UPPER LEFT OF BLOCK
         00008530 002d0000  
    1406                    
    1407 00008550     09e4          MOVI    TIT_LRX+(10000H*400),A4 ;COORDINATE OF LOWER RIGHT OF HELP AREA
         00008560 01900185  
    1408 00008580     e264          SUBXY   A3,A4                   ;THIS IS SIZE OF REGION TO BLANK
    1409 00008590     0d5f          CALLA   BLNKAREA                ;BLANK OUT THE HELP AREA
         000085a0 00000000! 
    1410 000085c0     0b09          ADDI    BOX_XGAP,A9             ;RETURN X FOR HELP MENUS
         000085d0     0002  
    1411 000085e0     09af          MMFM    SP,A3,A4,A5,A6
         000085f0     0078  
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   34

    1412 00008600     0960          RETS
    1413                    
    1414              0000  HM_JUST          EQU     0
    1415              0010  HM_COLOR         EQU     HM_JUST+WORD_SIZE
    1416              0020  HM_ENTS          EQU     HM_COLOR+WORD_SIZE
    1417              0030  HM_DATA          EQU     HM_ENTS+WORD_SIZE      ;ENTRY POINTERS
    1418                    
    1419              0100  HS_ROUT          EQU     PDATA             ;LONG-TEXT ROUTINE
    1420              0120  HS_X             EQU     HS_ROUT+LONG_SIZE ;WORD-X FOR TEXT ROUTINE
    1421              0130  HS_Y             EQU     HS_X+WORD_SIZE    ;WORD-CURRENT Y
    1422              0140  HS_ENTS          EQU     HS_Y+WORD_SIZE    ;WORD-ENTRIES LEFT TO DO
    1423              0150  HS_COLOR         EQU     HS_ENTS+WORD_SIZE ;WORD-COLOR OF MENU
    1424              0160  HS_PTR           EQU     HS_COLOR+WORD_SIZE ;LONG-CURRENT TEXT POINTER
    1425                    
    1426 00008610           H_SLAVE:
    1427 00008610     4d21          MOVE    A9,A1                     ;PUT THIS X VALUE IN A1
    1428                    
    1429 00008620     b500          MOVE    *A8(HM_JUST),A0,W         ;0 = CENTER  1=LEFT
         00008630     0000  
    1430 00008640     ca06          JRZ     HS_CENT                   ;CENTER....SETUP X ACCORDINGLY
    1431 00008650     09e0          MOVI    STRLNRM,A0                ;LEFT JUSTIFY ROUTIN
         00008660 00000000! 
    1432 00008680     0b01          ADDI    MB_XWID+HELP_X_MARGIN,A1  ;ADD MARGIN TO FORM X FOR TEXT
         00008690     000d  
    1433 000086a0     c006          JRUC    CENTER_JOIN               ;CONTINUE
    1434                    
    1435 000086b0           HS_CENT:
    1436 000086b0     09e0          MOVI    STRCNRM,A0                ;USE CENTERING ROUTINE
         000086c0 00000000! 
    1437 000086e0     0b01          ADDI    TIT_LRX,A1
         000086f0     0185  
    1438 00008700     2fe1          SRL     1,A1                      ;THIS IS CENTER X
    1439                    
    1440 00008710           CENTER_JOIN:
    1441 00008710     b02d          MOVE    A1,*A13(HS_X),W           ;STORE X
         00008720     0120  
    1442 00008730     b20d          MOVE    A0,*A13(HS_ROUT),L        ;STORE ROUTINE
         00008740     0100  
    1443                    
    1444 00008750     b501          MOVE    *A8(HM_ENTS),A1,W         ;GET NUMBER OF ENTRIES
         00008760     0020  
    1445 00008770     b02d          MOVE    A1,*A13(HS_ENTS),W        ;COUNT IT DOWN IN P-AREA
         00008780     0140  
    1446                    
    1447 00008790     b500          MOVE    *A8(HM_COLOR),A0,W        ;GET COLOR
         000087a0     0010  
    1448 000087b0     b00d          MOVE    A0,*A13(HS_COLOR),W       ;STASH IT
         000087c0     0150  
    1449                    
    1450 000087d0     0b08          ADDI    HM_DATA,A8                ;POINT AT 1ST ENTRY
         000087e0     0030  
    1451 000087f0     b30d          MOVE    A8,*A13(HS_PTR),L         ;NOW WE'RE READY.
         00008800     0160  
    1452 00008810     09c5          MOVI    HELP_DY,A5                ;DISTANCE PER ENTRY
         00008820     000c  
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   35

    1453 00008830     5e25          MPYU    A1,A5                     ;DISTANCE FOR ALL ENTRIES
    1454 00008840     0b05          ADDI    HELP_Y_MARGIN+(MB_YWID*2)+HELP_YLO_MARGIN,A5
         00008850     0012  
    1455 00008860     0d3f          CALLR   TOP_IN_A10
         00008870     003a  
    1456 00008880     4d44          MOVE    A10,A4                    ;MOVE Y OVER
    1457 00008890     2604          SLL     16,A4                     ;MAKE ROOM FOR X
    1458 000088a0     4124          ADD     A9,A4                     ;PUT IN THE X...THIS IS UPPER LEFT!
    1459                    
    1460 000088b0     4145          ADD     A10,A5                    ;ADD BASE TO OFFSET
    1461 000088c0     2605          SLL     16,A5                     ;PUT IN Y POSITION
    1462 000088d0     0b05          ADDI    TIT_LRX,A5                ;ADD IN THE X FOR THE CORNER
         000088e0     0185  
    1463 000088f0     0b0a          ADDI    MB_YWID+HELP_Y_MARGIN,A10  ;Y OF 1ST ENTRY
         00008900     000b  
    1464 00008910     b14d          MOVE    A10,*A13(HS_Y),W           ;PUT AWAY
         00008920     0130  
    1465                    
    1466 00008930     b5a9          MOVE    *A13(HS_COLOR),A9,W       ;GET THE COLOR FOR DOBORDER
         00008940     0150  
    1467                    
    1468 00008950     0d3f          CALLR   STD_BORD
         00008960     ff93  
    1469 00008970           NEXT_HELP:
    1470 00008970     b7a2          MOVE    *A13(HS_PTR),A2,L         ;GET OUR CURRENT POINTER
         00008980     0160  
    1471 00008990     9648          MOVE    *A2+,A8,L                 ;GET THE CURRENT MESSAGE POINTER
    1472 000089a0     b24d          MOVE    A2,*A13(HS_PTR),L         ;AND PUT POINTER BACK
         000089b0     0160  
    1473                    
    1474 000089c0     5600          CLR     A0
    1475 000089d0     b7a1          MOVE    *A13(HS_ROUT),A1,L        ;ROUTINE IN A1
         000089e0     0100  
    1476 000089f0     b5a6          MOVE    *A13(HS_COLOR),A6,W       ;STUFF COLOR
         00008a00     0150  
    1477                    
    1478 00008a10     b5a9          MOVE    *A13(HS_Y),A9,W           ;GET Y
         00008a20     0130  
    1479 00008a30     2609          SLL     16,A9                     ;SHIFT INTO PLACE
    1480 00008a40     b5aa          MOVE    *A13(HS_X),A10,W
         00008a50     0120  
    1481 00008a60     4149          ADD     A10,A9                    ;A9 IS NOW POINTING AT SCREEN
    1482                    
    1483 00008a70     09ca          MOVI    SPACING07,A10             ;SPACING
         00008a80     0001  
    1484 00008a90     09eb          MOVI    RD7FONT,A11               ;FONT IS BABY FONT
         00008aa0 00000000! 
    1485 00008ac0                   JSRP    LM_FINIS                  ;PRINT IT OUT!
    1486                    
    1487 00008b30     b5a9          MOVE    *A13(HS_Y),A9,W           ;GET THE Y
         00008b40     0130  
    1488 00008b50     0b09          ADDI    HELP_DY,A9                ;KICK IT
         00008b60     000c  
    1489 00008b70     b12d          MOVE    A9,*A13(HS_Y),W           ;PUT IT BACK
         00008b80     0130  
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   36

    1490                    
    1491 00008b90     b5a0          MOVE    *A13(HS_ENTS),A0,W        ;ENTRY COUNT
         00008ba0     0140  
    1492 00008bb0     1420          DEC     A0
    1493 00008bc0     b00d          MOVE    A0,*A13(HS_ENTS),W        ;PUT IT BACK
         00008bd0     0140  
    1494 00008be0     cbd8          JRNZ    NEXT_HELP
    1495                    
    1496 00008bf0     c080          JAUC    SUCIDE                    ;OUR WORK IS DONE!
         00008c00 00000000! 
    1497                    
    1498 00008c20           TOP_IN_A10:
    1499 00008c20     098f          MMTM    SP,A5
         00008c30     0400  
    1500 00008c40     0b6a          CMPI    0FFFFH,A10                ;IS THE TOP HALF ZERO?
         00008c50 ffff0000  
    1501 00008c70     c302          JRHI    TOP_IS_TOP                ;TOP IS SET..RETURN
    1502 00008c80     2fe5          SRL     1,A5                      ;TOP OF BOX IS HALF UP FROM MAIN MENU BAR CENTER
    1503 00008c90     44aa          SUB     A5,A10                    ;NOW A10 HAS Y BASE OF BOX
    1504 00008ca0           TOP_IS_TOP:
    1505 00008ca0     09af          MMFM    SP,A5
         00008cb0     0020  
    1506 00008cc0     0960          RETS
    1507                    
    1508 00008cd0           AREUSURE:
    1509 00008cd0     0d5f          CALLA   CLR_SCRN             ;BLANK IT ALL OUT!
         00008ce0 00000000! 
    1510 00008d00     b32d          MOVE    A9,*A13(PDATA),L     ;SAVE ROUTINE
         00008d10     0100  
    1511 00008d20     a34c          MOVE    A10,-*A12,L          ;AND CONFIRM MESSAGE
    1512                    
    1513 00008d30     0d3f          CALLR   SURE_BOX
         00008d40     0060  
    1514                    
    1515 00008d50     4d02          MOVE    A8,A2                ;PUT MESSAGE TEXT IN SAFE PLACE
    1516 00008d60     09e8          MOVI    MESS_SURE,A8         ;SETUP FOR TITLE
         00008d70 00009ea0' 
    1517 00008d90     0d5f          CALLA   LM_SETUP             ;STUFF REGGIES
         00008da0 00000000! 
    1518 00008dc0     4c48          MOVE    A2,A8                ;GET STRING IN THERE
    1519 00008dd0                   JSRP    LM_FINIS             ;AND PRINT IT
    1520                    
    1521 00008e40     09e8          MOVI    M_SURE,A8            ;NOW THE "ARE YOU SURE" PART
         00008e50 00009f40' 
    1522 00008e70                   JSRP    L_MESS               ;PUT IT UP.
    1523                    
    1524 00008ee0     09e8          MOVI    MEN_YN,A8            ;PUT UP THE "YES/NO" SELECTOR.
         00008ef0 00000000! 
    1525 00008f10     09c9          MOVI    2,A9                 ;CURSOR ON 2ND ENTRY (NO)
         00008f20     0002  
    1526                    
    1527 00008f30                   JSRP    B_MENU               ;AND GET A RESPONSE.
    1528 00008fa0     0b48          CMPI    1,A8                 ;WAS IT YES?
         00008fb0     fffe  
    1529 00008fc0     cb1f          JRNZ    SURE_X               ;NOPE....GET OUT
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   37

    1530                    
    1531 00008fd0     0d5f          CALLA   CLR_SCRN             ;CLEAR THE SCREEN FIRST, SO ROUTINE CAN PLOT!
         00008fe0 00000000! 
    1532                    
    1533 00009000     b7a0          MOVE    *A13(PDATA),A0,L     ;GET THE ROUTINE TO CALL
         00009010     0100  
    1534 00009020     09e7          MOVI    SURE_RET,A7
         00009030 00009070' 
    1535 00009050     a2ec          MOVE    A7,-*A12,L           ;PUSH RETURN ADDRESS
    1536 00009060     0160          JUMP    A0                   ;AND "JSRP" THE ROUTINE
    1537                    
    1538 00009070           SURE_RET:
    1539 00009070     0d3f          CALLR   SURE_BOX             ;BOX IT!
         00009080     002c  
    1540 00009090     9788          MOVE    *A12+,A8,L
    1541 000090a0                   JSRP    SUR_MESS             ;PRINT THE MESSAGE
    1542                    
    1543 00009110                   JSRP    ANY_BUT              ;NOW RETRIEVE ANY BUTTON THEN RETURN
    1544                    
    1545 00009180     5600          CLR     A0                   ;RETURN SUCCESS
    1546 00009190                   RETP
    1547                    
    1548 000091c0           SURE_X: 
    1549 000091c0     0b0c          ADDI    LONG_SIZE,A12        ;POP MESSAGE
         000091d0     0020  
    1550 000091e0     09c0          MOVI    2,A0                 ;RETURN FAILURE
         000091f0     0002  
    1551 00009200                   RETP
    1552                    
    1553 00009230           SUR_MESS:
    1554 00009230     a30c          MOVE    A8,-*A12,L
    1555 00009240     09e8          MOVI    MESS_CONFIRM,A8
         00009250 0000a060' 
    1556 00009270     0d5f          CALLA   LM_SETUP             ;GET CONFIRMATION DATA READY.
         00009280 00000000! 
    1557 000092a0     9788          MOVE    *A12+,A8,L
    1558 000092b0                   JSRP    LM_FINIS             ;PRINT OUR PART
    1559 00009320                   RETP
    1560                    
    1561 00009350           SURE_BOX:
    1562 00009350     09c9          MOVI    COLOR_YELLOW,A9
         00009360     0505  
    1563 00009370     09e4          MOVI    003D0025H,A4
         00009380 003d0025  
    1564 000093a0     09e5          MOVI    00F6016AH,A5
         000093b0 00f6016a  
    1565 000093d0     c000          jruc    STD_BORD            ;BORDER-IZE THE WHOLE THING.
         000093e0     feeb  
    1566                    
    1567 000093f0           CENT_BOX:
    1568 000093f0     09c9          MOVI    ROBO_RED,A9
         00009400     0303  
    1569 00009410           CBOX_COL:
    1570 00009410     09e4          MOVI    00450025H,A4
         00009420 00450025  
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   38

    1571 00009440     09e5          MOVI    00B4016AH,A5
         00009450 00b4016a  
    1572 00009470     c000          jruc    STD_BORD            ;BORDER-IZE THE WHOLE THING.
         00009480     fee1  
    1573                    
    1574                    
    1575              0032  INSTR_Y  EQU     INST_ULY+5
    1576              003c  INSTR_2Y EQU     INSTR_Y+10
    1577                    
    1578 00009490           MM_INST1
    1579 00009490                   MESS_MAC  RD7FONT,SPACING07,MENU_X,INSTR_Y,COLOR_BPR,STRCNRM,0
    1580 00009530       53          .byte   "SELECT WITH ANY STICK"
    1581 000095d8       00          .BYTE    0
    1582 000095e0                   .EVEN
    1583                    
    1584 000095e0           MM_INST2
    1585 000095e0                   MESS_MAC  RD7FONT,SPACING07,MENU_X,INSTR_2Y,COLOR_BPR,STRCNRM,0
    1586 00009680       41          .byte   "ACTIVATE WITH ANY BUTTON"
    1587 00009740       00          .BYTE    0
    1588 00009750                   .EVEN
    1589                    
    1590 00009750           MESS_DOOR
    1591 00009750                   MESS_MAC  RD7FONT,SPACING20,200,128,ROBO_RED,STRCNRM,0
    1592 000097f0       49          .byte  "INVALID GAME SETTINGS"
    1593 00009898       00          .BYTE    0,1                  ;0 = END OF STRING...1 = MORE MESSAGES!
    1594 000098b0                   .EVEN
    1595                    
    1596 000098b0           MESS_FAIL
    1597 000098b0                   MESS_MAC  RD7FONT,SPACING20,200,112,ROBO_RED,STRCNRM,0
    1598 00009950       49          .byte  "INVALID GAME SETTINGS"
    1599 000099f8       00          .BYTE    0,1                  ;0 = END OF STRING...1 = MORE MESSAGES!
    1600 00009a10                   .EVEN
    1601 00009a10                   MESS_MAC  RD7FONT,SPACING20,200,144,ROBO_WHITE,STRCNRM,0
    1602 00009ab0       41          .byte  "ATTEMPT TO RESTORE"
    1603 00009b40       00          .BYTE    0,1                  ;0 = END OF STRING...1 = MORE MESSAGES!
    1604 00009b50                   .EVEN
    1605 00009b50                   MESS_MAC  RD7FONT,SPACING20,200,164,ROBO_WHITE,STRCNRM,0
    1606 00009bf0       46          .byte  "FACTORY SETTINGS HAS FAILED."
    1607 00009cd0       00          .BYTE     0,0
    1608 00009ce0                   .EVEN
    1609                    
    1610 00009ce0           MESS_BITCHIN
    1611 00009ce0       41          .byte   "ADJUSTMENTS OK",0
    1612 00009d60                   .even
    1613                    
    1614 00009d60           MESS_TITLE
    1615 00009d60                   MESS_MAC  RD15FONT,SPACING20,TM_X,TM_Y,ROBO_GREEN,STRCNRM,0
    1616                    
    1617              001c  RV_Y    EQU      TM_Y+18
    1618                    
    1619 00009e00           MESS_REV
    1620 00009e00                   MESS_MAC  RD7FONT,SPACING20,TM_X,RV_Y,ROBO_YELLOW,STRCNRM,0
    1621 00009ea0           MESS_SURE
    1622 00009ea0                   MESS_MAC  RD15FONT,SPACING20,200,102,ROBO_LF,STRCNRM,0
    1623 00009f40           M_SURE
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   39

    1624 00009f40                   MESS_MAC  RD15FONT,SPACING20,200,128,ROBO_YELLOW,STRCNRM,0
    1625 00009fe0       41          .byte   "ARE YOU SURE?"
    1626 0000a048       00          .BYTE       0,0
    1627 0000a060                   .EVEN
    1628                    
    1629 0000a060           MESS_CONFIRM
    1630 0000a060                    MESS_MAC  RD15FONT,SPACING20,200,115,COLOR_LF,STRCNRM,0
    1631                    
    1632                    
    1633              0100  OP_LINE_CHAR    equ     PDATA
    1634              0110  OP_LINE_LINE    equ     PDATA+WORD_SIZE
    1635              0120  OP_LETS         equ     OP_LINE_LINE+WORD_SIZE
    1636              0210  OP_STIME        equ     OP_LETS+(30 * BYTE_SIZE)
    1637              0220  OP_SVAL         equ     OP_STIME+WORD_SIZE
    1638                    
    1639              0019  LET_DIST_X      equ     25
    1640              0018  LET_DIST_Y      equ     24
    1641              000e  LET_BOX_CX      equ     14
    1642              0002  LET_BOX_CY      equ     2
    1643              0003  LET_BOX_WX      equ     3
    1644              0001  LET_BOX_WY      equ     1
    1645              00a3  LET_START_Y1    equ     163
    1646              00bb  LET_START_Y2    equ     LET_START_Y1+LET_DIST_Y
    1647              00d3  LET_START_Y3    equ     LET_START_Y2+LET_DIST_Y
    1648              00eb  LET_START_Y4    equ     LET_START_Y3+LET_DIST_Y
    1649              0037  LET_INST1       equ     55
    1650              0016  LET_START_X     equ     22
    1651              0003  LET_LINE_MAX    equ     3
    1652              000e  LET_CHAR_MAX    equ     14
    1653              000c  LET_TEXT_GAP    equ     12
    1654              006e  LET_TEXT1       equ     110
    1655              007a  LET_TEXT2       equ     LET_TEXT1+LET_TEXT_GAP
    1656              0086  LET_TEXT3       equ     LET_TEXT2+LET_TEXT_GAP
    1657              0019  OP_MAX_CHARS    equ     CMESS_CHARS-1
    1658              0000! FONT_T          .equ    osgfont_t
    1659                    
    1660                    
    1661 00000120                   .bss    BLINE   ,16
    1662 00000130                   .bss    BCHAR   ,16
    1663                    
    1664 0000a100            SUBR   opmsg_main
    1665                    
    1666                            .if     PRINTER
    1667                            movk    1,a0
    1668                            calla   PBADGUY
    1669                            .endif
    1670                    
    1671 0000a100     0d5f          calla   CLR_SCRN
         0000a110 00000000! 
    1672 0000a130     09e2          movi    opmsg_s,a2
         0000a140 0000cff0' 
    1673 0000a160     09c3          movi    ROBO_YELLOW,a3
         0000a170     0505  
    1674 0000a180                   JSRP    TOP_BOX                 ;KICK OUT TOP BOX
    1675                    
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   40

    1676 0000a1f0     09e8          movi    OMINST1,a8
         0000a200 0000d080' 
    1677 0000a220                   JSRP    print_multi
    1678                    
    1679 0000a290                   SLEEPK  1
    1680                    
    1681 0000a2d0     5708          clr     a8                      ;Do 4 rows of letters
    1682 0000a2e0     1bca          movk    30,a10
    1683 0000a2f0     0d3f          callr   OPPLOTLINE
         0000a300     0256  
    1684                    
    1685 0000a310     1828          movk    1,a8
    1686 0000a320     1bca          movk    30,a10
    1687 0000a330     0d3f          callr   OPPLOTLINE
         0000a340     0252  
    1688                    
    1689 0000a350     1848          movk    2,a8
    1690 0000a360     1bca          movk    30,a10
    1691 0000a370     0d3f          callr   OPPLOTLINE
         0000a380     024e  
    1692                    
    1693 0000a390     1868          movk    3,a8
    1694 0000a3a0     1bca          movk    30,a10
    1695 0000a3b0     0d3f          callr   OPPLOTLINE
         0000a3c0     024a  
    1696                    
    1697 0000a3d0     5600          clr     a0
    1698 0000a3e0     0580          move    a0,@BLINE
         0000a3f0 00000120- 
    1699 0000a410     0580          move    a0,@BCHAR
         0000a420 00000130- 
    1700                    
    1701 0000a440     5708          clr     a8
    1702 0000a450     b10d          move    a8,*a13(OP_LINE_LINE)   ;ON THE FIRST LINE
         0000a460     0110  
    1703                    
    1704 0000a470     0d3f          callr   OM_STARTLINE            ;INITIALIZE ALL THE FLAGS FOR IT
         0000a480     013d  
    1705                    
    1706 0000a490     574a          clr     a10
    1707 0000a4a0     182b          movk    1,a11
    1708 0000a4b0     0d3f          callr   BOXCHAR                 ;BOX INITIAL ONE
         0000a4c0     0212  
    1709                    
    1710 0000a4d0     182b          movk    1,a11
    1711 0000a4e0     0d3f          callr   OMPLOTTEXT
         0000a4f0     013e  
    1712                    
    1713                    
    1714 0000a500     5600          clr     a0
    1715 0000a510     b00d          move    a0,*a13(OP_SVAL)
         0000a520     0220  
    1716 0000a530     b00d          move    a0,*a13(OP_STIME)
         0000a540     0210  
    1717                    
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   41

    1718 0000a550           DOLOOP                                  ;>Loop for stick and things
    1719 0000a550                   SLEEPK  1
    1720                    
    1721 0000a590     0d3f          callr   om_getstick             ;Check out the player board
         0000a5a0     00f5  
    1722 0000a5b0     cb05          jrnz    do1                     ;switch closed?
    1723 0000a5c0     b00d          move    a0,*a13(OP_SVAL)        ;Clear timer and direction
         0000a5d0     0220  
    1724 0000a5e0     b00d          move    a0,*a13(OP_STIME)
         0000a5f0     0210  
    1725 0000a600     c0f4          jruc    DOLOOP
    1726 0000a610           do1
    1727 0000a610     b5a1          move    *a13(OP_SVAL),A1        ;Get last direction
         0000a620     0220  
    1728 0000a630                   ANDK    7,a1                    ;Mask off repeat bit
    1729 0000a650     4801          cmp     a0,a1
    1730 0000a660     ca06          jrz     do2                     ;Still same thing?
    1731 0000a670     b00d          move    a0,*a13(OP_SVAL)
         0000a680     0220  
    1732 0000a690     5621          clr     a1
    1733 0000a6a0     b02d          move    a1,*a13(OP_STIME)       ;Clear the timer
         0000a6b0     0210  
    1734 0000a6c0     c02a          jruc    DODONE                  ;Process initial hit
    1735 0000a6d0           do2
    1736 0000a6d0     b5a1          MOVE    *A13(OP_SVAL),A1        ;SNAG THE REPEAT BIT
         0000a6e0     0220  
    1737 0000a6f0     0b81          ANDI    80H,A1
         0000a700 ffffff7f  
    1738 0000a720     cb15          JRNZ    DO3                     ;BR = IN REPEAT MODE
    1739 0000a730     b5a0          MOVE    *A13(OP_STIME),A0       ;GET TIMER
         0000a740     0210  
    1740 0000a750     1020          INC     A0
    1741 0000a760     b00d          MOVE    A0,*A13(OP_STIME)
         0000a770     0210  
    1742 0000a780     0b40          CMPI    15,A0
         0000a790     fff0  
    1743 0000a7a0     1f60          btst    4,a0
    1744 0000a7b0     c8d9          JRLO    DOLOOP                  ;GO BACK TO SLEEP
    1745 0000a7c0     5600          CLR     A0
    1746 0000a7d0     b00d          MOVE    A0,*A13(OP_STIME)       ;CLEAR OUT THE TIMER
         0000a7e0     0210  
    1747 0000a7f0     b5a1          MOVE    *A13(OP_SVAL),A1
         0000a800     0220  
    1748 0000a810     4c20          MOVE    A1,A0
    1749 0000a820     0ba1          ORI     80H,A1                  ;PUT UPPER BIT ON
         0000a830 00000080  
    1750 0000a850     b02d          MOVE    A1,*A13(OP_SVAL)        ;SET DIRECTION WITH REPEAT ON
         0000a860     0220  
    1751 0000a870     c00f          JRUC    DODONE
    1752 0000a880           DO3
    1753 0000a880     b5a0          MOVE    *A13(OP_STIME),A0       ;GET TIMER
         0000a890     0210  
    1754 0000a8a0     1020          INC     A0
    1755 0000a8b0     b00d          MOVE    A0,*A13(OP_STIME)
         0000a8c0     0210  
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   42

    1756 0000a8d0     0b40          CMPI    5,A0
         0000a8e0     fffa  
    1757 0000a8f0     c8c5          JRLO    DOLOOP                  ;GO BACK TO SLEEP
    1758 0000a900     5600          CLR     A0
    1759 0000a910     b00d          MOVE    A0,*A13(OP_STIME)       ;CLEAR OUT THE TIMER
         0000a920     0210  
    1760 0000a930     b5a0          MOVE    *A13(OP_SVAL),A0
         0000a940     0220  
    1761 0000a950                   ANDK    7,a0                    ;TURN OFF REPEAT BIT
    1762 0000a970           DODONE
    1763 0000a970     b5a1          move    *A13(OP_SVAL),a1        ;Get current entry
         0000a980     0220  
    1764 0000a990                   ANDK    7,a1
    1765 0000a9b0     05a8          move    @BLINE,a8
         0000a9c0 00000120- 
    1766 0000a9e0     05aa          move    @BCHAR,a10
         0000a9f0 00000130- 
    1767 0000aa10     576b          clr     a11
    1768 0000aa20     0d3f          callr   BOXCHAR                 ;UNHIGHLIGHT IT
         0000aa30     01bb  
    1769                    
    1770 0000aa40     0b41          CMPI    1,A1                    ;CHECK UP
         0000aa50     fffe  
    1771 0000aa60     cb02          JRNZ    DOC1
    1772 0000aa70     1428          DEC     A8
    1773 0000aa80     c035          JRUC    DOPROC
    1774 0000aa90           DOC1
    1775 0000aa90     0b41          CMPI    2,A1
         0000aaa0     fffd  
    1776 0000aab0     cb02          JRNZ    DOC2
    1777 0000aac0     1028          INC     A8
    1778 0000aad0     c030          JRUC    DOPROC
    1779 0000aae0           DOC2
    1780 0000aae0     0b41          CMPI    3,A1
         0000aaf0     fffc  
    1781 0000ab00     cb02          JRNZ    DOC3
    1782 0000ab10     142a          DEC     A10
    1783 0000ab20     c02b          JRUC    DOPROC
    1784 0000ab30           DOC3
    1785 0000ab30     0b41          CMPI    4,A1
         0000ab40     fffb  
    1786 0000ab50     cb02          JRNZ    DOC4
    1787 0000ab60     102a          INC     A10
    1788 0000ab70     c026          JRUC    DOPROC
    1789 0000ab80           DOC4
    1790 0000ab80     0b41          CMPI    5,A1                    ; DRAW BUTTON
         0000ab90     fffa  
    1791 0000aba0     cb15          JRNZ    DOCCLR                  ; WOOF WOOF
    1792 0000abb0                   SOUND1  select_snd1
    1793 0000ac10     0d3f          CALLR   OMADDCHAR               ; ADD THE CHAR IN A8/A10
         0000ac20     0109  
    1794 0000ac30     0b48          CMPI    0FFH,A8                 ; CHECK TO SEE IF DONE WITH ALL
         0000ac40     ff00  
    1795 0000ac50     ca37          JRZ     DOCEND
    1796 0000ac60     05a8          MOVE    @BLINE,A8
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   43

         0000ac70 00000120- 
    1797 0000ac90     05aa          MOVE    @BCHAR,A10
         0000aca0 00000130- 
    1798 0000acc0     182b          MOVK    1,A11
    1799 0000acd0     0d3f          CALLR   BOXCHAR                 ; TURN THE BOX BACK ON
         0000ace0     0190  
    1800 0000acf0     c085          JRUC    DOLOOP
    1801 0000ad00           DOCCLR
    1802 0000ad00     0b41          cmpi    6,a1                    ;Start button
         0000ad10     fff9  
    1803 0000ad20     cb82          jrne    DOLOOP
    1804                    
    1805 0000ad30     0d3f          callr   opmsg_clr
         0000ad40     0069  
    1806                    
    1807 0000ad50     c03d          jruc    DOCCLEAR
    1808                            
    1809 0000ad60     f3f7  cursor_snd4     .word   0f3f7H,08H,08083H,0     ;
    1810 0000ada0     f3f7  select_snd1     .word   0f3f7H,08H,08084H,0     ;select option sound
    1811 0000ade0           DOPROC
    1812 0000ade0                   SOUND1  cursor_snd4
    1813 0000ae40     4d08          move    a8,a8
    1814 0000ae50     c501          jrge    doc5
    1815 0000ae60     5708          clr     a8
    1816 0000ae70           doc5
    1817 0000ae70     0b48          cmpi    LET_LINE_MAX,a8
         0000ae80     fffc  
    1818 0000ae90     c601          jrle    doc6
    1819 0000aea0     1868          movk    LET_LINE_MAX,a8
    1820 0000aeb0           doc6
    1821 0000aeb0     4d4a          move    a10,a10
    1822 0000aec0     c501          jrge    doc7
    1823 0000aed0     19ca          movk    LET_CHAR_MAX,a10
    1824 0000aee0           doc7
    1825 0000aee0     0b4a          cmpi    LET_CHAR_MAX,a10
         0000aef0     fff1  
    1826 0000af00     c601          jrle    doc8
    1827 0000af10     574a          clr     a10
    1828 0000af20           doc8
    1829 0000af20     0588          move    a8,@BLINE
         0000af30 00000120- 
    1830 0000af50     058a          move    a10,@BCHAR
         0000af60 00000130- 
    1831 0000af80     182b          movk    1,a11
    1832 0000af90     0d3f          callr   BOXCHAR
         0000afa0     0164  
    1833 0000afb0     c000          jruc    DOLOOP
         0000afc0     ff58  
    1834                    
    1835                    
    1836                    
    1837 0000afd0           DOCEND
    1838 0000afd0                   SLEEPK  2                       ;GET EVERYBODY CAUGHT UP
    1839 0000b010     0d5f          CALLA   CLR_SCRN                ;CLEAR THE SCREEN
         0000b020 00000000! 
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   44

    1840 0000b040     0d3f          CALLR   SURE_BOX
         0000b050     fe2f  
    1841 0000b060     09e8          MOVI    MESS_SUCCESS,A8         ;THIS IS SUCCESS MESSAGE
         0000b070 0000b200' 
    1842 0000b090           emtmsm  JSRP    SUR_MESS                ;PRINT THE MESSAGE
    1843 0000b100     c080          jauc    ANY_BUT                 ;NOW RETRIEVE ANY BUTTON THEN RETURN
         0000b110 00000000! 
    1844                    
    1845 0000b130           DOCCLEAR
    1846 0000b130                   SLEEPK  2
    1847 0000b170     0d5f          CALLA   CLR_SCRN
         0000b180 00000000! 
    1848 0000b1a0     0d3f          CALLR   SURE_BOX
         0000b1b0     fe19  
    1849 0000b1c0     09e8          MOVI    MESS_CLEARED,A8
         0000b1d0 0000b280' 
    1850 0000b1f0     c0e9          jruc    emtmsm
    1851                    
    1852                    
    1853 0000b200           MESS_SUCCESS
    1854 0000b200       4d          .byte   "MESSAGE STORED",0
    1855 0000b280                   .even
    1856                    
    1857 0000b280           MESS_CLEARED
    1858 0000b280       4d          .byte   "MESSAGE CLEARED",0
    1859 0000b300                   .even
    1860                    
    1861 0000b300           BLASTMESS:                              ;GUY ENTERED A WHOLE MESSAGE
    1862 0000b300     0d5f          calla   ADJ_PAGE
         0000b310 00000000! 
    1863 0000b330     5600          clr     a0
    1864 0000b340     09e7          movi    VALID_CUSTOM,a7
         0000b350 01404c20  
    1865 0000b370     0d5f          calla   WC_WORD
         0000b380 00000000! 
    1866 0000b3a0     0d5f          calla   F_ADC_S                 ;FIX UP THE CHECKSUM
         0000b3b0 00000000! 
    1867 0000b3d0     0960          rets
    1868                    
    1869                    
    1870                    
    1871 0000b3e0            SUBR   opmsg_clr
    1872                    
    1873 0000b3e0     0d5f          calla   ADJ_PAGE
         0000b3f0 00000000! 
    1874                    
    1875 0000b410     09e7          movi    CUSTOM_MESSAGE,a7
         0000b420 01404740  
    1876 0000b440     1862          movk    CMESS_LINES,a2
    1877 0000b450     5600  hypllp  clr     a0
    1878 0000b460     0d5f          calla   WC_BYTEI                ;Write a null
         0000b470 00000000! 
    1879 0000b490     0b07          addi    CMESS_LINE_SIZE,a7
         0000b4a0     01a0  
    1880 0000b4b0     3ce2          dsj     a2,hypllp
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   45

    1881                    
    1882 0000b4c0     0d5f          calla   F_ADC_S                 ;Refresh checksum
         0000b4d0 00000000! 
    1883 0000b4f0     c0e0          jruc    BLASTMESS
    1884                    
    1885                    
    1886                    
    1887                    
    1888 0000b500           om_getstick
    1889                    
    1890 0000b500                   PUSH    a1
    1891                    
    1892 0000b510     07a0          move    @SWITCH,a0,L
         0000b520 01600000  
    1893 0000b540     03e0          not     a0
    1894 0000b550     4c01          move    a0,a1
    1895 0000b560     0b80          andi    0004007fh,a0            ;P1 draw/start/stick
         0000b570 fffbff80  
    1896 0000b590     0b81          andi    00207f00h,a1            ;P2 draw/start/stick
         0000b5a0 ffdf80ff  
    1897 0000b5c0     2f01          srl     8,a1
    1898 0000b5d0     5420          or      a1,a0
    1899 0000b5e0     05a1          move    @SWITCH+32,a1
         0000b5f0 01600020  
    1900 0000b610     03e1          not     a1
    1901 0000b620     0b81          andi    07fH,a1                 ;P3 draw/stick
         0000b630 ffffff80  
    1902 0000b650     5420          or      a1,a0
    1903                    
    1904 0000b660     1fe0          btst    0,a0                    ;U
    1905 0000b670     ca02          jrz     og2
    1906 0000b680     1820          movk    1,a0
    1907 0000b690     c019          jruc    hyplx
    1908 0000b6a0           og2
    1909 0000b6a0     1fc0          btst    1,a0                    ;D
    1910 0000b6b0     ca02          jrz     og3
    1911 0000b6c0     1840          movk    2,a0
    1912 0000b6d0     c015          jruc    hyplx
    1913 0000b6e0           og3
    1914 0000b6e0     1fa0          btst    2,a0                    ;L
    1915 0000b6f0     ca02          jrz     og4
    1916 0000b700     1860          movk    3,a0
    1917 0000b710     c011          jruc    hyplx
    1918 0000b720           og4
    1919 0000b720     1f80          btst    3,a0                    ;R
    1920 0000b730     ca02          jrz     og5
    1921 0000b740     1880          movk    4,a0
    1922 0000b750     c00d          jruc    hyplx
    1923 0000b760           og5
    1924 0000b760     09c1          movi    070H,a1
         0000b770     0070  
    1925 0000b780     5001          and     a0,a1
    1926 0000b790     ca02          jrz     og6
    1927 0000b7a0     18a0          movk    5,a0
    1928 0000b7b0     c007          jruc    hyplx
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   46

    1929 0000b7c0           og6
    1930 0000b7c0     0b80          andi    0ffffff80h,a0           ;Any other bits are start buttons
         0000b7d0 0000007f  
    1931 0000b7f0     ca02          jrz     og7
    1932 0000b800     18c0          movk    6,a0
    1933 0000b810     c001          jruc    hyplx
    1934 0000b820           og7
    1935 0000b820     5600          clr     a0
    1936 0000b830           hyplx
    1937 0000b830                   PULL    a1
    1938 0000b840     4c00          move    a0,a0
    1939 0000b850     0960          rets
    1940                    
    1941                    
    1942                    
    1943 0000b860           OM_STARTLINE
    1944                    
    1945 0000b860                   PUSH    A0
    1946 0000b870     5600          CLR     A0
    1947 0000b880     b00d          MOVE    A0,*A13(OP_LETS)
         0000b890     0120  
    1948 0000b8a0     b00d          MOVE    A0,*A13(OP_LINE_CHAR)
         0000b8b0     0100  
    1949 0000b8c0                   PULL    A0
    1950                    
    1951 0000b8d0     0960          RETS
    1952                    
    1953                    
    1954 0000b8e0           OMPLOTTEXT
    1955                    
    1956 0000b8e0     098f          MMTM    SP,A8,A10,A11
         0000b8f0     00b0  
    1957                    
    1958 0000b900                   PUSH    A11
    1959 0000b910     09e8          MOVI    OMTSETUP,A8
         0000b920 0000d660' 
    1960 0000b940     0d5f          CALLA   LM_SETUP
         0000b950 00000000! 
    1961 0000b970     4da8          MOVE    A13,A8
    1962 0000b980     0b08          ADDI    OP_LETS,A8
         0000b990     0120  
    1963 0000b9a0     b5a9          MOVE    *A13(OP_LINE_LINE),A9,W
         0000b9b0     0110  
    1964 0000b9c0     24a9          SLL     5,A9
    1965 0000b9d0     0b29          ADDI    OMLOC,A9
         0000b9e0 0000c590' 
    1966 0000ba00     8729          MOVE    *A9,A9,L
    1967 0000ba10     2609          SLL     16,A9
    1968 0000ba20     098f          MMTM    SP,A3,A4,A9
         0000ba30     1840  
    1969 0000ba40     4d23          MOVE    A9,A3
    1970 0000ba50     0d03          SUBI    20000H,A3
         0000ba60 fffdffff  
    1971 0000ba80     09e4          MOVI    [LET_TEXT_GAP+2,394],A4
         0000ba90 000e018a  
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   47

    1972 0000bab0     0d5f          CALLA   BLNKAREA
         0000bac0 00000000! 
    1973 0000bae0     09af          MMFM    SP,A3,A4,A9
         0000baf0     0218  
    1974 0000bb00     0b09          ADDI    200,A9
         0000bb10     00c8  
    1975 0000bb20                   JSRP    LM_FINIS
    1976                    
    1977 0000bb90                   PULL    A5
    1978 0000bba0     4ca5          MOVE    A5,A5                   ;FLAG FOR UNDERSCORE OR NOT
    1979 0000bbb0     ca0d          JRZ     NOUNDER
    1980 0000bbc0     09c6          movi    ROBO_LASER,a6
         0000bbd0     3e3e  
    1981 0000bbe0     09e8          movi    underscore_s,a8
         0000bbf0 0000d700' 
    1982 0000bc10     10a9          addk    5,a9                    ;SHIFT THE LITTLE GUY OVER
    1983 0000bc20                   JSRP    LM_FINIS
    1984 0000bc90           NOUNDER
    1985 0000bc90     09af          MMFM    SP,A8,A10,A11
         0000bca0     0d00  
    1986 0000bcb0     0960          RETS
    1987                    
    1988                    
    1989                    
    1990 0000bcc0           OMADDCHAR
    1991 0000bcc0                   PUSH    a8,a10
    1992                    
    1993 0000bce0     24a8          sll     5,a8
    1994 0000bcf0     0b28          addi    OLTAB,a8                ;+Base
         0000bd00 0000cd30' 
    1995 0000bd20     8708          move    *a8,a8,L
    1996 0000bd30     246a          sll     3,a10
    1997 0000bd40     4148          add     a10,a8                  ;char offset
    1998 0000bd50     8f00          movb    *a8,a0                  ;snag the char
    1999 0000bd60     0b40          cmpi    '_',a0
         0000bd70     ffa0  
    2000 0000bd80     cb09          jrne    pncz20
    2001                    
    2002 0000bd90     b5a1          move    *a13(OP_LINE_CHAR),a1   ;0BacHkspace
         0000bda0     0100  
    2003 0000bdb0     ca38          jrz     pnczx
    2004 0000bdc0     1421          dec     a1
    2005 0000bdd0     b02d          move    a1,*a13(OP_LINE_CHAR)
         0000bde0     0100  
    2006 0000bdf0     4c22          move    a1,a2
    2007 0000be00     5600          clr     a0
    2008 0000be10     c026          jruc    rubent
    2009                    
    2010 0000be20           pncz20
    2011 0000be20     0b40          cmpi    '^',a0
         0000be30     ffa1  
    2012 0000be40     cb1a          jrne    pnczaddchar
    2013                    
    2014 0000be50     576b          clr     a11
    2015 0000be60     0d3f          callr   OMPLOTTEXT              ; GET RID OF THE FLASHING UNDERSCORE
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   48

         0000be70     ffa6  
    2016 0000be80     5600          clr     a0
    2017 0000be90     0580          move    a0,@BLINE
         0000bea0 00000120- 
    2018 0000bec0     0580          move    a0,@BCHAR
         0000bed0 00000130- 
    2019 0000bef0     0d3f          callr   OM_STORECMOS            ; WELL, BABY -- STORE IT
         0000bf00     0048  
    2020 0000bf10     b5a8          MOVE    *A13(OP_LINE_LINE),A8   ; GRAB THE LINE
         0000bf20     0110  
    2021 0000bf30     0b48          CMPI    2,A8
         0000bf40     fffd  
    2022 0000bf50     c921          JRHS    OMADONE
    2023 0000bf60     1028          INC     A8
    2024 0000bf70     b10d          MOVE    A8,*A13(OP_LINE_LINE)   ; ON THE FIRST LINE
         0000bf80     0110  
    2025 0000bf90     0d3f          CALLR   OM_STARTLINE            ; INITIALIZE ALL THE FLAGS FOR IT
         0000bfa0     ff8b  
    2026 0000bfb0     182b          MOVK    1,A11
    2027 0000bfc0     0d3f          CALLR   OMPLOTTEXT
         0000bfd0     ff90  
    2028 0000bfe0     c015          jruc    pnczx
    2029                    
    2030                    
    2031 0000bff0           pnczaddchar
    2032                    
    2033 0000bff0     b5a1          MOVE    *A13(OP_LINE_CHAR),A1
         0000c000     0100  
    2034 0000c010     4c22          MOVE    A1,A2
    2035 0000c020     0b41          CMPI    OP_MAX_CHARS,A1
         0000c030     ffe6  
    2036 0000c040     c926          JRHS    OMACMAX
    2037 0000c050     1021          INC     A1
    2038 0000c060     b02d          MOVE    A1,*A13(OP_LINE_CHAR)
         0000c070     0100  
    2039 0000c080           rubent
    2040 0000c080     4da8          move    a13,a8
    2041 0000c090     0b08          ADDI    OP_LETS,A8
         0000c0a0     0120  
    2042 0000c0b0     2462          SLL     3,A2
    2043 0000c0c0     4048          ADD     A2,A8                   ;OFFSET INTO LOCAL STORAGE
    2044 0000c0d0     8c08          MOVB    A0,*A8
    2045 0000c0e0     1108          ADDK    8,A8
    2046 0000c0f0     5600          CLR     A0
    2047 0000c100     8c08          MOVB    A0,*A8                  ;MAKE SURE ZERO TERMINATED
    2048 0000c110     182b          MOVK    1,A11
    2049 0000c120     0d3f          CALLR   OMPLOTTEXT
         0000c130     ff7a  
    2050 0000c140     09af  pnczx   MMFM    SP,A8,A10
         0000c150     0500  
    2051 0000c160     0960          RETS
    2052                    
    2053 0000c170           OMADONE                                 ;COME HERE WHEN REALLY DONE
    2054 0000c170     0d5f          CALLA   ADJ_PAGE                ;GUY ENTERED A WHOLE MESSAGE
         0000c180 00000000! 
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   49

    2055 0000c1a0     09e7          MOVI    VALID_CUSTOM,A7
         0000c1b0 01404c20  
    2056 0000c1d0     09e0          MOVI    VALID_VALUE,A0
         0000c1e0 0000eabc  
    2057 0000c200     0d5f          CALLA   WC_WORD
         0000c210 00000000! 
    2058 0000c230     0d5f          CALLA   F_ADC_S                 ;FIX UP THE CHECKSUM
         0000c240 00000000! 
    2059 0000c260     09af          MMFM    SP,A8,A10
         0000c270     0500  
    2060 0000c280     09c8          MOVI    0FFH,A8                 ;FLAG DONE WITH EVERYTHING
         0000c290     00ff  
    2061 0000c2a0     0960          RETS
    2062                    
    2063 0000c2b0           OMACMAX
    2064 0000c2b0     09af          mmfm    sp,a8,a10
         0000c2c0     0500  
    2065 0000c2d0     576b          clr     a11
    2066 0000c2e0     0d3f          callr   BOXCHAR
         0000c2f0     002f  
    2067 0000c300     1868          movk    3,a8
    2068 0000c310     19ca          movk    14,a10
    2069 0000c320     0588          move    a8,@BLINE
         0000c330 00000120- 
    2070 0000c350     058a          move    a10,@BCHAR
         0000c360 00000130- 
    2071 0000c380     0960          rets
    2072                    
    2073                    
    2074                    
    2075 0000c390           OM_STORECMOS
    2076 0000c390     0d5f          CALLA   ADJ_PAGE                ;POINT AT ADJUSTMENTS PAGE
         0000c3a0 00000000! 
    2077 0000c3c0     b5a7          MOVE    *A13(OP_LINE_LINE),A7
         0000c3d0     0110  
    2078 0000c3e0     09c6          MOVI    CMESS_LINE_SIZE,A6
         0000c3f0     01a0  
    2079 0000c400     5ec7          MPYU    A6,A7                   ;OFFSET ME, BABY
    2080 0000c410     0b27          ADDI    CUSTOM_MESSAGE,A7       ;A7 IS CMOS LOCATION
         0000c420 01404740  
    2081 0000c440     4da6          MOVE    A13,A6
    2082 0000c450     0b06          ADDI    OP_LETS,A6              ;A6 IS THE PROCESS BLOCK LOC
         0000c460     0120  
    2083 0000c470     1b25          movk    CMESS_CHARS-1,a5        ;CHARS/LINE
    2084                    
    2085 0000c480           cmos_loop
    2086 0000c480     8ec0          movb    *a6,a0                  ;fetch a character
    2087 0000c490     0b80          andi    BYTE_MASK,A0
         0000c4a0 ffffff00  
    2088 0000c4c0     0d5f          calla   WC_BYTEI                ;WRITE A BYTE
         0000c4d0 00000000! 
    2089 0000c4f0     1106          addk    BYTE_SIZE,A6            ;POINT AT NEXT BYTE
    2090 0000c500     3d25          dsj     a5,cmos_loop
    2091                    
    2092 0000c510     5600          clr     a0
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   50

    2093 0000c520     0d5f          calla   WC_BYTEI                ;Write a null
         0000c530 00000000! 
    2094                    
    2095 0000c550     0d5f          calla   F_ADC_S                 ;REFRESH CHECKSUM
         0000c560 00000000! 
    2096                    
    2097 0000c580     0960          rets
    2098                    
    2099 0000c590 0000006e  OMLOC   .LONG   LET_TEXT1, LET_TEXT2, LET_TEXT3
    2100                    
    2101                    
    2102                    
    2103                    
    2104 0000c5f0           BOXCHAR
    2105 0000c5f0     098f          MMTM    SP,A1,A8,A10
         0000c600     40a0  
    2106                    
    2107 0000c610     09c1          MOVI    LET_DIST_Y,A1
         0000c620     0018  
    2108 0000c630     5f01          MPYU    A8,A1                           ; DISTANCE
    2109 0000c640     0b01          ADDI    LET_START_Y1-LET_BOX_CY,A1
         0000c650     00a1  
    2110 0000c660     2601          SLL     16,A1
    2111 0000c670     4c24          MOVE    A1,A4
    2112 0000c680     09c1          MOVI    LET_DIST_X,A1
         0000c690     0019  
    2113 0000c6a0     5f41          MPYU    A10,A1
    2114 0000c6b0     0b01          ADDI    LET_START_X-LET_BOX_CX,A1
         0000c6c0     0008  
    2115 0000c6d0     ec24          MOVX    A1,A4                           ; UPPER LEFT IN A4
    2116 0000c6e0     4c85          MOVE    A4,A5   
    2117 0000c6f0     09e0          MOVI    [LET_DIST_Y+LET_BOX_WY,LET_DIST_X+LET_BOX_WX],A0
         0000c700 0019001c  
    2118 0000c720     e005          ADDXY   A0,A5                           ; LOWER RIGHT IN A5
    2119                    
    2120 0000c730     09e0          MOVI    [1,1],A0                        ; BORDER HEIGHT,WIDTH
         0000c740 00010001  
    2121 0000c760     09c9          MOVI    ROBO_BLACK,A9                   ; DOBORDER IS RETARDED
         0000c770     1414  
    2122 0000c780     4d6b          MOVE    A11,A11
    2123 0000c790     ca02          JRZ     BC1
    2124 0000c7a0     09c9          MOVI    ROBO_LF,A9
         0000c7b0     3e3e  
    2125 0000c7c0           BC1
    2126 0000c7c0     0d3f          CALLR   DOBORDER
         0000c7d0     fb6c  
    2127                    
    2128 0000c7e0     4d6b          MOVE    A11,A11
    2129 0000c7f0     cb02          JRNZ    BC2
    2130 0000c800     09ca          MOVI    0FFH,A10
         0000c810     00ff  
    2131 0000c820           BC2
    2132 0000c820     0d3f          CALLR   OPPLOTLINE
         0000c830     0003  
    2133                    
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   51

    2134 0000c840     09af          MMFM    SP,A1,A8,A10
         0000c850     0502  
    2135 0000c860     0960          RETS
    2136                    
    2137                    
    2138                    
    2139 00000140                   .bss    char_s  ,16
    2140                    
    2141 0000c870           OPPLOTLINE
    2142                    
    2143 0000c870                   PUSH    a8,a9,a10,a11
    2144                    
    2145 0000c890     4d09          move    a8,a9
    2146 0000c8a0     24a8          sll     5,a8                    ;*32
    2147 0000c8b0     0b28          addi    OLTAB,a8
         0000c8c0 0000cd30' 
    2148 0000c8e0     8708          move    *a8,a8,L
    2149 0000c8f0     2489          sll     4,a9
    2150 0000c900     0b29          addi    OLYTAB,a9
         0000c910 0000cdb0' 
    2151 0000c930     8529          move    *a9,a9
    2152                            
    2153 0000c940     2609          sll     16,a9                   ;Get in the y position
    2154 0000c950     12c9          addk    LET_START_X,a9
    2155 0000c960           rdbdlp
    2156 0000c960     8f00          movb    *a8,a0                  ;GRAB CHAR NUMBER
    2157 0000c970     4c00          move    a0,a0   
    2158 0000c980     ca2d          jrz     rdbdx
    2159 0000c990     05e0          movb    a0,@char_s
         0000c9a0 00000140- 
    2160 0000c9c0                   PUSH    a8
    2161 0000c9d0                   PUSH    a9
    2162 0000c9e0                   PUSH    a10
    2163 0000c9f0                   PUSH    a9
    2164 0000ca00     09e0          movi    REDPAL,a0               ;*Palette
         0000ca10 00000000! 
    2165 0000ca30     4d4a          move    a10,a10
    2166 0000ca40     cb03          jrnz    opl1
    2167 0000ca50     09e0          movi    WHITEPAL,a0
         0000ca60 00000000! 
    2168 0000ca80     0d5f  opl1    calla   pal_getf
         0000ca90 00000000! 
    2169 0000cab0     4c05          move    a0,a5
    2170                    
    2171 0000cac0     09e8          movi    OP_MESS,a8
         0000cad0 0000cc90' 
    2172 0000caf0     0d5f          calla   LM_SETUP
         0000cb00 00000000! 
    2173 0000cb20     4ca6          move    a5,a6                   ;Color
    2174 0000cb30                   PULL    a9                      ;SET THE POSITION OF THE CHAR
    2175 0000cb40     09e8          movi    char_s,a8
         0000cb50 00000140- 
    2176 0000cb70                   JSRP    LM_FINIS
    2177                    
    2178 0000cbe0                   PULL    a10
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   52

    2179 0000cbf0     142a          dec     a10
    2180 0000cc00                   PULL    a9
    2181 0000cc10                   PULL    a8
    2182 0000cc20     1108          addk    8,a8
    2183 0000cc30     0b09          addi    LET_DIST_X,a9
         0000cc40     0019  
    2184 0000cc50     c0d0          jruc    rdbdlp
    2185                    
    2186 0000cc60           rdbdx   PULL    a8,a9,a10,a11
    2187 0000cc80     0960          rets
    2188                    
    2189                    
    2190 0000cc90           OP_MESS
    2191 0000cc90                   MESS_MAC FONT_T,1,200,95,REDPAL,STRCNRM_1,0
    2192 0000cd30                   .even
    2193                    
    2194 0000cd30 0000cdf0' OLTAB   .long   OL1TAB, OL2TAB, OL3TAB, OL4TAB
    2195 0000cdb0     00a3  OLYTAB  .word   LET_START_Y1, LET_START_Y2, LET_START_Y3, LET_START_Y4
    2196                    
    2197 0000cdf0       41  OL1TAB  .byte   "ABCDEFGHI123?!_",0
    2198 0000ce70       4a  OL2TAB  .byte   "JKLMNOPQR456()_",0
    2199 0000cef0       53  OL3TAB  .byte   "STUVWXYZ 7890:_",0
    2200 0000cf70       5e  OL4TAB  .byte   "^_ #$&-./'   _^",0
    2201                    
    2202 0000cff0       4f  opmsg_s .byte   "OPERATOR MESSAGE",0
    2203 0000d080                   .even
    2204 0000d080           OMINST1
    2205 0000d080                   MESS_MAC RD7FONT,SPACING07,200,LET_INST1,ROBO_WHITE,STRCNRM,0
    2206 0000d120       55          .byte   "USE PLAYER 1 OR 2 CONTROLS TO ENTER A MESSAGE",0,1
    2207 0000d298       4f          .byte   "OF UP TO 3 LINES OF 25 LETTERS PER LINE.",0,1
    2208 0000d3e8       53          .byte   "SELECT end TO END EACH LINE.",0,1
    2209 0000d4d8       50          .byte   "PRESS PLAYER 1 OR 2 START TO CLEAR OUT MESSAGE.",0,0
    2210 0000d660                   .even
    2211                    
    2212 0000d660           OMTSETUP
    2213 0000d660                   MESS_MAC   RD7FONT,SPACING07,200,LET_INST1,ROBO_BLUE,STRCNRM,0
    2214 0000d700                   .even
    2215                    
    2216 0000d700       2d  underscore_s    .byte   "-",0
    2217 0000d710                   .even
    2218                    
    2219                    
    2220                    
    2221 0000d710            SUBRP  print_multi
    2222                    
    2223 0000d710                   PUSH    a2
    2224                    
    2225 0000d720     4d02          move    a8,a2
    2226 0000d730     0d5f          calla   LM_SETUP
         0000d740 00000000! 
    2227 0000d760     4d23          move    a9,a3           ;1st XY
    2228                    
    2229 0000d770           oxgolp  PUSH    a8
    2230 0000d780     4c48          move    a2,a8
    2231 0000d790     0d5f          calla   LM_SETUP
TMS340 COFF Macro Assembler Version 6.10     Tue Dec 19 01:45:19 2023
 Copyright (c) 1985-1991  Texas Instruments Incorporated 

test program                                                         PAGE   53

         0000d7a0 00000000! 
    2232 0000d7c0                   PULL    a8
    2233                    
    2234 0000d7d0     4c69          move    a3,a9
    2235                    
    2236 0000d7e0                   JSRP    LM_FINIS
    2237 0000d850     0b23          addi    [12,0],a3       ;Next Y
         0000d860 000c0000  
    2238                    
    2239 0000d880     8f00          movb    *a8,a0
    2240 0000d890     1108          addk    8,a8
    2241 0000d8a0     4c00          move    a0,a0
    2242 0000d8b0     cbeb          jrnz    oxgolp
    2243                    
    2244 0000d8c0                   PULL    a2
    2245 0000d8d0                   RETP
    2246                    
    2247                    
    2248                    
    2249                    
    2250                    ASCIIE  .macro  str
    2251                    
    2252                            .var    i,c,e
    2253                            .eval   1,i
    2254                            .eval   1,e
    2255                            .loop   $symlen(str)
    2256                            .asg    :str(i):,c
    2257                            .byte   0ffh & (':c:'+e)
    2258                            .eval   i+1,i
    2259                            .eval   e+7,e
    2260                            .endloop
    2261                            .byte   0ffh & :e:
    2262                    
    2263                            .endm
    2264                    
    2265 0000d900       01          .byte   1,2,4,8,16,32,64,128    ;ID
    2266                    
    2267 0000d940                   ASCIIE  "NBA-JAM-COPYRIGHT-1993-MIDWAY-MANUFACTURING-COMPANY"
    2268 0000dae0                   ASCIIE  "ALL-RIGHTS-RESERVED"
    2269 0000db80                   ASCIIE  "PROGRAMMED-BY-SHAWN-LIPTAK-&-MARK-TURMELL-&-JAMIE-RIVETT"
    2270                    
    2271                    
    2272                    
    2273                    
    2274 0000dd50                   .end

 No Errors,  No Warnings
